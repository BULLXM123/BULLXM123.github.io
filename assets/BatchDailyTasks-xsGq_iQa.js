import{b as onBeforeUnmount,o as onMounted,c as computed,r as ref,e as reactive,w as watch,n as nextTick,S as createElementBlock,V as createBaseVNode,Z as createVNode,X as createBlock,Y as createCommentVNode,a2 as toDisplayString,$ as withCtx,W as resolveComponent,U as openBlock,j as createTextVNode,N as unref,F as Fragment,R as renderList,a0 as withModifiers,I as normalizeStyle,L as normalizeClass}from"./vue-vendor-CjWJpnUV.js";import{u as useTokenStore,p as preloadQuestions}from"./index-DyiAMGIZ.js";import{_ as _export_sfc}from"./plugin-vueexport-helper-DlAUqK2U.js";import{u as useMessage}from"./ui-vendor-bYSxkbvo.js";import{S as Settings}from"./Settings-C4JVFvuj.js";import"./utils-C42QaX6I.js";class ConnectionPoolManager{constructor(e,t={}){this.tokenStore=e,this.config={maxConnections:t.maxConnections||3,connectionTimeout:t.connectionTimeout||3e4,idleTimeout:t.idleTimeout||6e4,queueTimeout:t.queueTimeout||12e4,reconnectDelay:t.reconnectDelay||1e3,maxRetries:t.maxRetries||3},this.activeConnections=new Map,this.connectionQueue=[],this.connectionLocks=new Map,this.isProcessingQueue=!1,this.stats={totalAcquired:0,totalReleased:0,totalTimeout:0,totalFailed:0,queueWaitTime:[],connectionDuration:[]},this.startAutoCleanup(),console.log("[ConnectionPool] 连接池管理器已初始化",this.config)}async acquire(e,t=5){const o=Date.now();console.log(`[ConnectionPool] 请求获取连接: ${e}, 优先级: ${t}`);try{if(this.activeConnections.has(e)){const a=this.activeConnections.get(e),i=this.tokenStore.getWebSocketStatus(e);if(i==="connected")return console.log(`[ConnectionPool] 连接已存在且健康: ${e}`),a.lastUsed=Date.now(),!0;console.log(`[ConnectionPool] 连接不健康，先释放: ${e}, 状态: ${i}`),await this.release(e,!1)}if(this.activeConnections.size<this.config.maxConnections)if(await this._createConnection(e)){this.stats.totalAcquired++;const i=Date.now()-o;return this.stats.queueWaitTime.push(i),console.log(`[ConnectionPool] 连接已建立: ${e}, 耗时: ${i}ms`),!0}else return this.stats.totalFailed++,console.error(`[ConnectionPool] 连接建立失败: ${e}`),!1;else return console.log(`[ConnectionPool] 连接池已满 (${this.activeConnections.size}/${this.config.maxConnections}), 加入队列: ${e}`),await this._enqueueAndWait(e,t,o)}catch(a){return this.stats.totalFailed++,console.error(`[ConnectionPool] 获取连接异常: ${e}`,a),!1}}async release(e,t=!0){console.log(`[ConnectionPool] 释放连接: ${e}, 断开: ${t}`);try{const o=this.activeConnections.get(e);if(o){const a=Date.now()-o.acquiredAt;this.stats.connectionDuration.push(a),this.activeConnections.delete(e),this.stats.totalReleased++,console.log(`[ConnectionPool] 连接已从池中移除: ${e}, 持续: ${a}ms`)}if(t)try{await this.tokenStore.disconnectWebSocket(e),console.log(`[ConnectionPool] WebSocket已断开: ${e}`)}catch(a){console.error(`[ConnectionPool] 断开WebSocket失败: ${e}`,a)}this.connectionLocks.delete(e),this._processQueue()}catch(o){console.error(`[ConnectionPool] 释放连接异常: ${e}`,o)}}async releaseAll(){console.log(`[ConnectionPool] 释放所有连接, 当前: ${this.activeConnections.size}个`);const e=Array.from(this.activeConnections.keys());for(const t of e)await this.release(t,!0);this.connectionQueue=[],console.log("[ConnectionPool] 所有连接已释放")}getStats(){const e=this.stats.queueWaitTime.length>0?this.stats.queueWaitTime.reduce((o,a)=>o+a,0)/this.stats.queueWaitTime.length:0,t=this.stats.connectionDuration.length>0?this.stats.connectionDuration.reduce((o,a)=>o+a,0)/this.stats.connectionDuration.length:0;return{activeConnections:this.activeConnections.size,maxConnections:this.config.maxConnections,queueLength:this.connectionQueue.length,totalAcquired:this.stats.totalAcquired,totalReleased:this.stats.totalReleased,totalFailed:this.stats.totalFailed,totalTimeout:this.stats.totalTimeout,avgQueueWaitTime:Math.round(e),avgConnectionDuration:Math.round(t),activeConnectionIds:Array.from(this.activeConnections.keys())}}cleanup(){const e=Date.now();let t=0;for(const[o,a]of this.activeConnections.entries()){const i=e-a.lastUsed;i>this.config.idleTimeout&&(console.log(`[ConnectionPool] 清理空闲连接: ${o}, 空闲: ${i}ms`),this.release(o,!0),t++)}this.connectionQueue=this.connectionQueue.filter(o=>{const a=e-o.queuedAt;return a>this.config.queueTimeout?(console.log(`[ConnectionPool] 清理超时队列项: ${o.tokenId}, 等待: ${a}ms`),o.reject&&o.reject(new Error("Queue timeout")),this.stats.totalTimeout++,!1):!0}),(t>0||this.connectionQueue.length>0)&&console.log(`[ConnectionPool] 清理完成, 移除: ${t}个连接, 队列剩余: ${this.connectionQueue.length}个`)}startAutoCleanup(){this.cleanupInterval=setInterval(()=>{this.cleanup()},3e4),console.log("[ConnectionPool] 自动清理定时器已启动 (30秒/次)")}stopAutoCleanup(){this.cleanupInterval&&(clearInterval(this.cleanupInterval),this.cleanupInterval=null,console.log("[ConnectionPool] 自动清理定时器已停止"))}async destroy(){console.log("[ConnectionPool] 销毁连接池..."),this.stopAutoCleanup(),await this.releaseAll(),this.activeConnections.clear(),this.connectionQueue=[],this.connectionLocks.clear(),console.log("[ConnectionPool] 连接池已销毁")}async _createConnection(e){var t,o;if(this.connectionLocks.has(e))return console.log(`[ConnectionPool] 连接正在创建中: ${e}`),!1;this.connectionLocks.set(e,{startedAt:Date.now()});try{console.log(`[ConnectionPool] 正在调用 tokenStore.connectWebSocket: ${e}`),await this.tokenStore.connectWebSocket(e);const a=this.config.connectionTimeout,i=Date.now();for(;Date.now()-i<a;){const l=this.tokenStore.getWebSocketStatus(e);if(l==="connected")return this.activeConnections.set(e,{tokenId:e,acquiredAt:Date.now(),lastUsed:Date.now(),status:"connected"}),!0;if(l==="error"){const y=((o=(((t=this.tokenStore.wsConnections)==null?void 0:t[e])||{}).lastError)==null?void 0:o.error)||"未知错误";return console.error(`[ConnectionPool] 连接错误: ${e}, 原因: ${y}`),!1}await new Promise(d=>setTimeout(d,100))}const c=this.tokenStore.getWebSocketStatus(e);return console.error(`[ConnectionPool] 连接超时: ${e}, 当前状态: ${c}, 等待时间: ${a}ms`),this.stats.totalTimeout++,!1}catch(a){return console.error(`[ConnectionPool] 创建连接异常: ${e}`,a),!1}finally{this.connectionLocks.delete(e)}}async _enqueueAndWait(e,t,o){return new Promise((a,i)=>{const c={tokenId:e,priority:t,queuedAt:Date.now(),startTime:o,resolve:a,reject:i},l=this.connectionQueue.findIndex(d=>d.priority<t);l===-1?this.connectionQueue.push(c):this.connectionQueue.splice(l,0,c),console.log(`[ConnectionPool] 已加入队列: ${e}, 优先级: ${t}, 队列位置: ${l===-1?this.connectionQueue.length:l+1}/${this.connectionQueue.length}`)})}async _processQueue(){if(!(this.isProcessingQueue||this.connectionQueue.length===0)&&!(this.activeConnections.size>=this.config.maxConnections)){this.isProcessingQueue=!0;try{for(;this.connectionQueue.length>0&&this.activeConnections.size<this.config.maxConnections;){const e=this.connectionQueue.shift();if(!e)break;if(console.log(`[ConnectionPool] 处理队列项: ${e.tokenId}`),await this._createConnection(e.tokenId)){this.stats.totalAcquired++;const o=Date.now()-e.startTime;this.stats.queueWaitTime.push(o),e.resolve&&e.resolve(!0),console.log(`[ConnectionPool] 队列项已完成: ${e.tokenId}, 总等待: ${o}ms`)}else this.stats.totalFailed++,e.reject&&e.reject(new Error("Failed to create connection"));await new Promise(o=>setTimeout(o,500))}}finally{this.isProcessingQueue=!1}}}}class TaskQueueManager{constructor(e={}){this.config={maxConcurrency:e.maxConcurrency||1,taskTimeout:e.taskTimeout||6e4,retryDelay:e.retryDelay||2e3,maxRetries:e.maxRetries||2},this.queue=[],this.runningTasks=new Map,this.completedTasks=[],this.isPaused=!1,this.isProcessing=!1,this.stats={totalEnqueued:0,totalCompleted:0,totalFailed:0,totalRetried:0,totalCancelled:0,executionTimes:[]},console.log("[TaskQueue] 任务队列管理器已初始化",this.config)}enqueue(e,t=5){const o={id:e.id||`task_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,name:e.name||"Unnamed Task",execute:e.execute,data:e.data||{},priority:t,retryCount:0,enqueuedAt:Date.now(),status:"queued"},a=this.queue.findIndex(i=>i.priority<t);return a===-1?this.queue.push(o):this.queue.splice(a,0,o),this.stats.totalEnqueued++,console.log(`[TaskQueue] 任务已加入队列: ${o.name} (ID: ${o.id}), 优先级: ${t}, 队列位置: ${a===-1?this.queue.length:a+1}/${this.queue.length}`),this.process(),o.id}dequeue(){if(this.queue.length===0)return null;const e=this.queue.shift();return console.log(`[TaskQueue] 取出任务: ${e.name} (ID: ${e.id})`),e}async process(){if(this.isPaused){console.log("[TaskQueue] 队列已暂停，等待恢复...");return}if(!this.isProcessing){this.isProcessing=!0;try{for(;this.queue.length>0&&this.runningTasks.size<this.config.maxConcurrency&&!this.isPaused;){const e=this.dequeue();if(!e)break;this._executeTask(e),await new Promise(t=>setTimeout(t,100))}}finally{this.isProcessing=!1}}}pause(){this.isPaused=!0,console.log("[TaskQueue] 队列已暂停")}resume(){this.isPaused=!1,console.log("[TaskQueue] 队列已恢复"),this.process()}cancel(e){const t=this.queue.findIndex(o=>o.id===e);if(t!==-1){const o=this.queue.splice(t,1)[0];return o.status="cancelled",this.stats.totalCancelled++,console.log(`[TaskQueue] 任务已从队列取消: ${o.name} (ID: ${e})`),!0}if(this.runningTasks.has(e)){const o=this.runningTasks.get(e);return o.status="cancelling",console.log(`[TaskQueue] 正在运行的任务已标记取消: ${o.name} (ID: ${e})`),!0}return console.log(`[TaskQueue] 未找到任务: ${e}`),!1}clear(){const e=this.queue.length;this.queue=[],this.stats.totalCancelled+=e,console.log(`[TaskQueue] 队列已清空, 取消: ${e}个任务`)}getStatus(){return{queueLength:this.queue.length,runningTasks:this.runningTasks.size,completedTasks:this.completedTasks.length,isPaused:this.isPaused,stats:{...this.stats}}}getStats(){const e=this.stats.executionTimes.length>0?this.stats.executionTimes.reduce((t,o)=>t+o,0)/this.stats.executionTimes.length:0;return{...this.stats,avgExecutionTime:Math.round(e),successRate:this.stats.totalEnqueued>0?(this.stats.totalCompleted/this.stats.totalEnqueued*100).toFixed(2)+"%":"0%"}}async _executeTask(e){const t=Date.now();e.status="running",e.startedAt=t,this.runningTasks.set(e.id,e),console.log(`[TaskQueue] 开始执行任务: ${e.name} (ID: ${e.id})`);try{const o=new Promise((c,l)=>{setTimeout(()=>l(new Error("Task timeout")),this.config.taskTimeout)}),a=await Promise.race([e.execute(e.data),o]);if(e.status==="cancelling")throw new Error("Task cancelled");e.status="completed",e.result=a,e.completedAt=Date.now();const i=e.completedAt-t;this.stats.executionTimes.push(i),this.stats.totalCompleted++,console.log(`[TaskQueue] 任务完成: ${e.name} (ID: ${e.id}), 耗时: ${i}ms`),this.runningTasks.delete(e.id),this.completedTasks.push(e),this.completedTasks.length>100&&(this.completedTasks=this.completedTasks.slice(-100))}catch(o){console.error(`[TaskQueue] 任务执行失败: ${e.name} (ID: ${e.id})`,o),e.retryCount<this.config.maxRetries&&e.status!=="cancelling"?(e.retryCount++,this.stats.totalRetried++,console.log(`[TaskQueue] 任务将重试: ${e.name} (ID: ${e.id}), 第${e.retryCount}次重试`),setTimeout(()=>{e.status="queued",this.queue.unshift(e),this.process()},this.config.retryDelay)):(e.status=e.status==="cancelling"?"cancelled":"failed",e.error=o.message,e.completedAt=Date.now(),this.stats.totalFailed++,e.status==="cancelled"&&this.stats.totalCancelled++,this.runningTasks.delete(e.id),this.completedTasks.push(e))}finally{this.process()}}}class ConnectionHealthMonitor{constructor(e,t,o={}){this.tokenStore=e,this.connectionPool=t,this.config={checkInterval:o.checkInterval||3e4,healthTimeout:o.healthTimeout||5e3,reconnectDelay:o.reconnectDelay||2e3,maxReconnectAttempts:o.maxReconnectAttempts||3,statsRetentionTime:o.statsRetentionTime||36e5},this.isMonitoring=!1,this.monitoringInterval=null,this.healthCheckResults=new Map,this.reconnectAttempts=new Map,this.stats={totalChecks:0,totalHealthy:0,totalUnhealthy:0,totalReconnects:0,totalReconnectFailures:0,checkHistory:[],connectionEvents:[]},console.log("[HealthMonitor] 连接健康监控器已初始化",this.config)}startMonitoring(){if(this.isMonitoring){console.log("[HealthMonitor] 监控已在运行中");return}this.isMonitoring=!0,this.checkAllConnections(),this.monitoringInterval=setInterval(()=>{this.checkAllConnections()},this.config.checkInterval),console.log(`[HealthMonitor] 监控已启动, 检查间隔: ${this.config.checkInterval}ms`)}stopMonitoring(){this.isMonitoring&&(this.isMonitoring=!1,this.monitoringInterval&&(clearInterval(this.monitoringInterval),this.monitoringInterval=null),console.log("[HealthMonitor] 监控已停止"))}async checkAllConnections(){if(!this.isMonitoring)return;const t=this.connectionPool.getStats().activeConnectionIds||[];console.log(`[HealthMonitor] 开始健康检查, 活跃连接: ${t.length}个`),this.stats.totalChecks++;let o=0,a=0;for(const i of t)await this.checkHealth(i)?(o++,this.reconnectAttempts.delete(i)):(a++,await this.autoReconnect(i));this.stats.totalHealthy+=o,this.stats.totalUnhealthy+=a,this.stats.checkHistory.push({timestamp:Date.now(),healthy:o,unhealthy:a,total:t.length}),this.stats.checkHistory.length>100&&(this.stats.checkHistory=this.stats.checkHistory.slice(-100)),console.log(`[HealthMonitor] 健康检查完成, 健康: ${o}, 不健康: ${a}`),this._cleanupOldStats()}async checkHealth(e){try{const t=this.tokenStore.getWebSocketStatus(e),o=this.tokenStore.getWebSocketClient(e);if(t!=="connected")return console.log(`[HealthMonitor] 连接不健康: ${e}, 状态: ${t}`),this._recordHealthResult(e,!1,`status: ${t}`),!1;if(!o)return console.log(`[HealthMonitor] 连接不健康: ${e}, 客户端不存在`),this._recordHealthResult(e,!1,"no client"),!1;try{const a=this.tokenStore.sendMessageWithPromise(e,"heart_beat",{},this.config.healthTimeout);return await Promise.race([a,new Promise((i,c)=>setTimeout(()=>c(new Error("Heartbeat timeout")),this.config.healthTimeout))]),console.log(`[HealthMonitor] 连接健康: ${e}`),this._recordHealthResult(e,!0),!0}catch(a){return console.log(`[HealthMonitor] 心跳失败: ${e}`,a.message),this._recordHealthResult(e,!1,`heartbeat failed: ${a.message}`),!1}}catch(t){return console.error(`[HealthMonitor] 健康检查异常: ${e}`,t),this._recordHealthResult(e,!1,`error: ${t.message}`),!1}}async autoReconnect(e){const t=this.reconnectAttempts.get(e)||0;if(t>=this.config.maxReconnectAttempts)return console.log(`[HealthMonitor] 达到最大重连次数: ${e}, 放弃重连`),this._recordEvent(e,"reconnect_abandoned",{attempts:t}),!1;console.log(`[HealthMonitor] 开始自动重连: ${e}, 第${t+1}次尝试`),this.reconnectAttempts.set(e,t+1),this.stats.totalReconnects++;try{return await this.connectionPool.release(e,!0),await new Promise(a=>setTimeout(a,this.config.reconnectDelay)),await this.connectionPool.acquire(e,10)?(console.log(`[HealthMonitor] 重连操作成功: ${e}, 等待下一次健康检查验证`),this._recordEvent(e,"reconnect_success",{attempts:t+1}),!0):(console.log(`[HealthMonitor] 重连失败: ${e}`),this.stats.totalReconnectFailures++,this._recordEvent(e,"reconnect_failed",{attempts:t+1}),!1)}catch(o){return console.error(`[HealthMonitor] 重连异常: ${e}`,o),this.stats.totalReconnectFailures++,this._recordEvent(e,"reconnect_error",{attempts:t+1,error:o.message}),!1}}collectStats(){const e=this.connectionPool.getStats();return{monitoring:{isActive:this.isMonitoring,checkInterval:this.config.checkInterval,totalChecks:this.stats.totalChecks,totalHealthy:this.stats.totalHealthy,totalUnhealthy:this.stats.totalUnhealthy,totalReconnects:this.stats.totalReconnects,totalReconnectFailures:this.stats.totalReconnectFailures,healthRate:this.stats.totalChecks>0?(this.stats.totalHealthy/this.stats.totalChecks*100).toFixed(2)+"%":"N/A"},pool:e,recentChecks:this.stats.checkHistory.slice(-10),recentEvents:this.stats.connectionEvents.slice(-20)}}getHealthReport(){const t=this.connectionPool.getStats().activeConnectionIds||[],o={};for(const a of t){const i=this.healthCheckResults.get(a);o[a]=i||{healthy:!1,reason:"no data"}}return{timestamp:Date.now(),totalConnections:t.length,healthyConnections:Array.from(this.healthCheckResults.values()).filter(a=>a.healthy).length,unhealthyConnections:Array.from(this.healthCheckResults.values()).filter(a=>!a.healthy).length,detailedHealth:o,stats:this.collectStats()}}resetStats(){this.stats={totalChecks:0,totalHealthy:0,totalUnhealthy:0,totalReconnects:0,totalReconnectFailures:0,checkHistory:[],connectionEvents:[]},this.healthCheckResults.clear(),this.reconnectAttempts.clear(),console.log("[HealthMonitor] 统计数据已重置")}_recordHealthResult(e,t,o=""){this.healthCheckResults.set(e,{healthy:t,reason:o,timestamp:Date.now()})}_recordEvent(e,t,o={}){this.stats.connectionEvents.push({timestamp:Date.now(),tokenId:e,event:t,details:o}),this.stats.connectionEvents.length>200&&(this.stats.connectionEvents=this.stats.connectionEvents.slice(-200))}_cleanupOldStats(){const t=Date.now()-this.config.statsRetentionTime;for(const[o,a]of this.healthCheckResults.entries())a.timestamp<t&&this.healthCheckResults.delete(o);this.stats.connectionEvents=this.stats.connectionEvents.filter(o=>o.timestamp>t)}}const _hoisted_1={class:"batch-daily-tasks"},_hoisted_2={class:"main-layout"},_hoisted_3={class:"left-column"},_hoisted_4={class:"page-header",style:{display:"flex","justify-content":"space-between","align-items":"center","flex-wrap":"wrap",gap:"12px"}},_hoisted_5={style:{display:"flex","align-items":"center",gap:"16px"}},_hoisted_6={style:{display:"flex","align-items":"center",gap:"12px",padding:"8px 12px","background-color":"#f8f9fa","border-radius":"8px",border:"1px solid #e9ecef"}},_hoisted_7={style:{"font-size":"14px",color:"#495057"}},_hoisted_8={key:0,style:{"font-size":"14px","font-weight":"500",color:"#1677ff"}},_hoisted_9={key:1,style:{"font-size":"14px",color:"#6c757d"}},_hoisted_10={style:{display:"flex",gap:"8px"}},_hoisted_11={style:{display:"flex","align-items":"center",gap:"12px",padding:"8px 12px","background-color":"#f8f9fa","border-radius":"8px",border:"1px solid #e9ecef"}},_hoisted_12={class:"token-row"},_hoisted_13={class:"token-item"},_hoisted_14={class:"task-preview",style:{margin:"16px 0",padding:"16px",border:"1px solid #e5e7eb","border-radius":"8px","background-color":"#fafafa"}},_hoisted_15={key:0,style:{display:"flex","flex-direction":"column","align-items":"center",padding:"12px","background-color":"white","border-radius":"6px","box-shadow":"0 2px 8px rgba(0, 0, 0, 0.1)"}},_hoisted_16={style:{"font-size":"16px","font-weight":"bold","margin-bottom":"8px"}},_hoisted_17={key:1,style:{"text-align":"center",padding:"24px",color:"#6b7280","font-style":"italic"}},_hoisted_18={key:0,class:"tasks-count"},_hoisted_19={key:1,class:"tasks-count"},_hoisted_20={class:"right-column",style:{display:"flex","flex-direction":"column",gap:"16px"}},_hoisted_21={class:"monitor-content",style:{"font-size":"12px"}},_hoisted_22={class:"monitor-grid",style:{display:"grid","grid-template-columns":"1fr 1fr",gap:"8px","margin-bottom":"12px"}},_hoisted_23={class:"monitor-item"},_hoisted_24={style:{"font-size":"16px","font-weight":"bold",color:"#1677ff"}},_hoisted_25={class:"monitor-item"},_hoisted_26={key:0,class:"active-tasks"},_hoisted_27={key:1,style:{"text-align":"center",color:"#9ca3af",padding:"8px",border:"1px dashed #e5e7eb","border-radius":"4px"}},_hoisted_28={class:"custom-card-header"},_hoisted_29={class:"card-title"},_hoisted_30={class:"log-header-controls"},_hoisted_31={class:"time"},_hoisted_32={class:"message"},_hoisted_33={class:"execution-stats-bar",style:{"margin-top":"12px",padding:"8px 12px",background:"#f9fafb","border-radius":"6px",border:"1px solid #f3f4f6",display:"flex","align-items":"center","justify-content":"space-between"}},_hoisted_34={style:{display:"flex",gap:"16px","align-items":"center"}},_hoisted_35={style:{"max-height":"200px","overflow-y":"auto"}},_hoisted_36={style:{display:"flex","flex-direction":"column",gap:"2px"}},_hoisted_37={style:{color:"#ef4444","font-weight":"500"}},_hoisted_38={style:{color:"#9ca3af","font-size":"10px","padding-left":"8px"}},_hoisted_39={style:{"font-size":"12px",color:"#9ca3af"}},_hoisted_40={class:"settings-content"},_hoisted_41={class:"settings-grid"},_hoisted_42={class:"setting-item"},_hoisted_43={class:"setting-item"},_hoisted_44={class:"setting-item"},_hoisted_45={class:"setting-switches"},_hoisted_46={class:"switch-row"},_hoisted_47={class:"switch-row"},_hoisted_48={class:"switch-row"},_hoisted_49={class:"switch-row"},_hoisted_50={class:"switch-row"},_hoisted_51={class:"switch-row"},_hoisted_52={class:"switch-row"},_hoisted_53={class:"modal-actions",style:{"margin-top":"20px","text-align":"right"}},_hoisted_54={class:"settings-content"},_hoisted_55={class:"settings-grid"},_hoisted_56={class:"setting-item"},_hoisted_57={key:0,class:"setting-item"},_hoisted_58={class:"recipient-info",style:{background:"#f7f8fa",padding:"16px","border-radius":"8px",border:"1px solid #e5e7eb",display:"flex","align-items":"flex-start",gap:"16px",transition:"all 0.3s ease"}},_hoisted_59={class:"avatar-container",style:{position:"relative",width:"80px",height:"80px","border-radius":"50%",overflow:"hidden",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)","box-shadow":"0 4px 12px rgba(0, 0, 0, 0.15)",display:"flex","align-items":"center","justify-content":"center",transition:"all 0.3s ease"}},_hoisted_60=["src"],_hoisted_61={key:1,class:"avatar-fallback",style:{display:"flex","align-items":"center","justify-content":"center",width:"100%",height:"100%",color:"white","font-size":"24px","font-weight":"bold","text-shadow":"0 2px 4px rgba(0, 0, 0, 0.3)"}},_hoisted_62={key:2,class:"avatar-loading",style:{position:"absolute",top:"0",left:"0",width:"100%",height:"100%",background:"rgba(0, 0, 0, 0.5)",display:"flex","align-items":"center","justify-content":"center","border-radius":"50%"}},_hoisted_63={class:"role-info",style:{flex:"1","min-width":"0"}},_hoisted_64={style:{"margin-bottom":"12px","font-size":"18px","font-weight":"bold",color:"#1d2129","text-shadow":"0 1px 2px rgba(0,0,0,0.1)"}},_hoisted_65={class:"role-info-grid",style:{display:"grid","grid-template-columns":"1fr 1fr",gap:"12px"}},_hoisted_66={class:"info-item"},_hoisted_67={class:"info-value",style:{"font-size":"14px","font-weight":"500",color:"#1d2129"}},_hoisted_68={class:"info-item"},_hoisted_69={class:"info-value",style:{"font-size":"14px","font-weight":"500",color:"#1d2129"}},_hoisted_70={class:"info-item"},_hoisted_71={class:"info-value",style:{"font-size":"16px","font-weight":"600",color:"#667eea"}},_hoisted_72={class:"info-item"},_hoisted_73={class:"info-value",style:{"font-size":"14px","font-weight":"500",color:"#1d2129"}},_hoisted_74={class:"info-item",style:{"grid-column":"1 / -1"}},_hoisted_75={class:"info-value",style:{"font-size":"14px","font-weight":"500",color:"#1d2129"}},_hoisted_76={class:"setting-item"},_hoisted_77={class:"modal-actions",style:{"margin-top":"20px","text-align":"right"}},_hoisted_78={class:"settings-content"},_hoisted_79={class:"settings-grid"},_hoisted_80={key:0,class:"setting-item"},_hoisted_81={key:1,class:"setting-item"},_hoisted_82={class:"setting-item"},_hoisted_83={class:"modal-actions",style:{"margin-top":"20px","text-align":"right"}},_hoisted_84={class:"tasks-list",style:{"max-height":"600px","overflow-y":"auto"}},_hoisted_85={style:{display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"8px"}},_hoisted_86={style:{"font-weight":"bold"}},_hoisted_87={style:{"margin-bottom":"4px"}},_hoisted_88={style:{"margin-bottom":"4px"}},_hoisted_89={style:{"margin-bottom":"4px"}},_hoisted_90={style:{"margin-bottom":"4px"}},_hoisted_91={style:{"margin-bottom":"8px"}},_hoisted_92={style:{display:"flex",gap:"8px"}},_hoisted_93={key:0,style:{"text-align":"center",padding:"24px",color:"#6b7280"}},_hoisted_94={class:"settings-content"},_hoisted_95={class:"settings-grid"},_hoisted_96={class:"setting-item"},_hoisted_97={class:"setting-item"},_hoisted_98={key:0,class:"setting-item"},_hoisted_99={key:1,class:"setting-item"},_hoisted_100={key:0,class:"cron-parser"},_hoisted_101={key:0,class:"cron-validation success"},_hoisted_102={key:1,class:"cron-validation error"},_hoisted_103={key:2,class:"cron-next-runs"},_hoisted_104={class:"setting-item"},_hoisted_105={style:{display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"8px"}},_hoisted_106={class:"setting-item"},_hoisted_107={style:{display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"8px"}},_hoisted_108={class:"modal-actions",style:{"margin-top":"20px","text-align":"right"}},_hoisted_109={class:"settings-content"},_hoisted_110={class:"settings-grid"},_hoisted_111={class:"setting-item"},_hoisted_112={class:"setting-item"},_hoisted_113={class:"setting-item"},_hoisted_114={class:"setting-item"},_hoisted_115={class:"setting-item"},_hoisted_116={class:"setting-item"},_hoisted_117={class:"setting-item"},_hoisted_118={class:"setting-item",style:{"flex-direction":"row","justify-content":"space-between","align-items":"center"}},_hoisted_119={class:"setting-item",style:{"flex-direction":"row","justify-content":"space-between","align-items":"center"}},_hoisted_120={class:"setting-item",style:{"flex-direction":"row","justify-content":"space-between","align-items":"center"}},_hoisted_121={class:"setting-item",style:{"flex-direction":"row","justify-content":"space-between","align-items":"center"}},_hoisted_122={class:"setting-item",style:{"flex-direction":"row","justify-content":"space-between","align-items":"center"}},_hoisted_123={class:"setting-item",style:{"flex-direction":"row","justify-content":"space-between","align-items":"center"}},_hoisted_124={class:"setting-item",style:{"flex-direction":"row","justify-content":"space-between","align-items":"center"}},_hoisted_125={class:"setting-item",style:{"flex-direction":"row","justify-content":"space-between","align-items":"center"}},_hoisted_126={class:"modal-actions",style:{"margin-top":"20px","text-align":"right"}},FISH_TARGET=320,ARENA_TARGET=240,FOUR_HOURS_MS=4*60*60*1e3,_sfc_main={__name:"BatchDailyTasks",setup(__props){const tokenStore=useTokenStore(),message=useMessage(),connectionPool=new ConnectionPoolManager(tokenStore,{maxConnections:3,connectionTimeout:3e4,idleTimeout:12e4,queueTimeout:3e5});new TaskQueueManager({maxConcurrency:1,taskTimeout:3e5,maxRetries:2});const healthMonitor=new ConnectionHealthMonitor(tokenStore,connectionPool,{checkInterval:6e4,healthTimeout:5e3,maxReconnectAttempts:3});onBeforeUnmount(()=>{console.log("[BatchDailyTasks] 组件卸载，清理连接池资源"),healthMonitor.stopMonitoring(),connectionPool.stopAutoCleanup(),connectionPool.releaseAll()}),onMounted(()=>{console.log("[BatchDailyTasks] 组件加载完成，启动健康监控"),healthMonitor.startMonitoring()});const tokens=computed(()=>tokenStore.gameTokens),isCarActivityOpen=computed(()=>{const s=new Date().getDay();return s>=1&&s<=3}),ismengjingActivityOpen=computed(()=>{const s=new Date().getDay();return s===0||s===1||s===3||s===4}),isbaokuActivityOpen=computed(()=>{const s=new Date().getDay();return s!=1&&s!=2}),isarenaActivityOpen=computed(()=>{const s=new Date().getHours();return s>=6&&s<22}),getCurrentActivityWeek=computed(()=>{const s=new Date,e=new Date("2025-12-12T12:00:00"),t=7*24*60*60*1e3,o=3*t,a=s-e;if(a<0)return null;const i=a%o;return i<t?"黑市周":i<2*t?"招募周":"宝箱周"}),isWeirdTowerActivityOpen=computed(()=>getCurrentActivityWeek.value==="黑市周"),selectedTokens=ref([]),tokenStatus=ref({}),isRunning=ref(!1),shouldStop=ref(!1),showSettingsModal=ref(!1),currentSettingsTokenId=ref(null),currentSettingsTokenName=ref(""),currentSettings=reactive({arenaFormation:1,bossFormation:1,bossTimes:2,claimBottle:!0,payRecruit:!0,openBox:!0,arenaEnable:!0,claimHangUp:!0,claimEmail:!0,blackMarketPurchase:!0}),showHelperModal=ref(!1),helperType=ref("box"),helperSettings=reactive({boxType:2001,fishType:1,count:100}),helperModalTitle=computed(()=>({box:"批量开宝箱",fish:"批量钓鱼",recruit:"批量招募"})[helperType.value]||"批量助手"),showBatchSettingsModal=ref(!1),batchSettings=reactive({boxCount:100,fishCount:100,recruitCount:100,defaultBoxType:2001,defaultFishType:1,receiverId:"",password:"",hideScheduledTasksModule:!1,tokenListColumns:2,commandDelay:500,taskDelay:500,maxConnections:3,connectionTimeout:3e4,taskRetryCount:1,delayBetweenTasks:1e3}),loadBatchSettings=()=>{try{const s=localStorage.getItem("batchSettings");if(s){const e=JSON.parse(s);Object.assign(batchSettings,e)}}catch(s){console.error("Failed to load batch settings:",s)}},saveBatchSettings=()=>{try{localStorage.setItem("batchSettings",JSON.stringify(batchSettings)),message.success("定时批量任务设置已保存"),showBatchSettingsModal.value=!1}catch(s){console.error("Failed to save batch settings:",s),message.error("保存设置失败")}},openBatchSettings=()=>{loadBatchSettings(),showBatchSettingsModal.value=!0};onMounted(()=>{loadBatchSettings(),startMonitor()});const showLegacyGiftModal=ref(!1),recipientIdInput=ref(""),recipientIdError=ref(""),recipientInfo=ref(null),isQueryingRecipient=ref(!1),giftQuantity=ref(10),securityPassword=ref(""),isAvatarLoading=ref(!1),avatarLoadError=ref(!1),scheduledTasks=ref([]),showTaskModal=ref(!1),showTasksModal=ref(!1),editingTask=ref(null),taskForm=reactive({name:"",runType:"daily",runTime:null,cronExpression:"",selectedTokens:[],selectedTasks:[],enabled:!0}),cronValidation=ref({valid:!0,message:""}),cronNextRuns=ref([]),poolStats=ref({activeConnections:0,maxConnections:3,queueLength:0,activeTasks:[]}),healthReport=ref({totalConnections:0,healthyConnections:0,unhealthyConnections:0}),startMonitor=()=>{setInterval(()=>{if(connectionPool){const s=connectionPool.getStats();poolStats.value={...s,activeTasks:Array.from(connectionPool.activeConnections.entries()).map(([e,t])=>({tokenId:e,priority:t.priority}))}}healthMonitor&&(healthReport.value=healthMonitor.getHealthReport())},2e3)},availableTasks=[{label:"日常任务",value:"startBatch"},{label:"领取挂机",value:"claimHangUpRewards"},{label:"一键加钟",value:"batchAddHangUpTime"},{label:"重置罐子",value:"resetBottles"},{label:"一键领取罐子",value:"batchlingguanzi"},{label:"一键爬塔",value:"climbTower"},{label:"一键答题",value:"batchStudy"},{label:"智能发车",value:"batchSmartSendCar"},{label:"一键收车",value:"batchClaimCars"},{label:"批量开箱",value:"batchOpenBox"},{label:"领取宝箱积分",value:"batchClaimBoxPointReward"},{label:"批量钓鱼",value:"batchFish"},{label:"批量招募",value:"batchRecruit"},{label:"一键宝库前3层",value:"batchbaoku13"},{label:"一键宝库4,5层",value:"batchbaoku45"},{label:"一键梦境",value:"batchmengjing"},{label:"一键俱乐部签到",value:"batchclubsign"},{label:"一键竞技场战斗3次",value:"batcharenafight"},{label:"一键钓鱼补齐",value:"batchTopUpFish"},{label:"一键竞技场补齐",value:"batchTopUpArena"},{label:"一键领取怪异塔免费道具",value:"batchClaimFreeEnergy"},{label:"一键购买四圣碎片",value:"legion_storebuygoods"},{label:"一键黑市采购",value:"store_purchase"},{label:"免费领取珍宝阁",value:"collection_claimfreereward"},{label:"批量领取功法残卷",value:"batchLegacyClaim"},{label:"批量赠送功法残卷",value:"batchLegacyGiftSendEnhanced"}],loadScheduledTasks=()=>{try{const s=localStorage.getItem("scheduledTasks");if(s){const e=JSON.parse(s);scheduledTasks.value=Array.isArray(e)?e:[]}else scheduledTasks.value=[]}catch(s){console.error("Failed to load scheduled tasks:",s),scheduledTasks.value=[]}},saveScheduledTasks=()=>{try{const s=JSON.stringify(scheduledTasks.value);localStorage.setItem("scheduledTasks",s);const e=localStorage.getItem("scheduledTasks")}catch(s){console.error("Failed to save scheduled tasks:",s)}},openTaskModal=()=>{editingTask.value=null,Object.assign(taskForm,{name:"",runType:"daily",runTime:void 0,cronExpression:"",selectedTokens:[],selectedTasks:[],enabled:!0}),showTaskModal.value=!0},editTask=s=>{editingTask.value=s;const e={...s};if(s.runType==="daily"&&s.runTime&&typeof s.runTime=="string"){const[t,o]=s.runTime.split(":").map(Number),a=new Date;e.runTime=new Date(a.getFullYear(),a.getMonth(),a.getDate(),t,o)}Object.assign(taskForm,e),showTaskModal.value=!0},validateCronExpression=s=>{if(!s)return{valid:!1,message:"Cron表达式不能为空"};const e=s.split(" ").filter(Boolean);if(e.length!==5)return{valid:!1,message:"Cron表达式必须包含5个字段：分 时 日 月 周"};const[t,o,a,i,c]=e,l=(m,g,v,u)=>{if(m==="*")return{valid:!0};if(m.includes("/")){const w=m.split("/");if(w.length!==2)return{valid:!1,message:`${u}字段步长格式错误`};const[x,T]=w,b=parseInt(T);if(isNaN(b)||b<=0)return{valid:!1,message:`${u}字段步长必须是正整数`};if(x!=="*")if(x.includes(",")){const S=x.split(",");for(const n of S)if(n.includes("-")){const k=n.split("-");if(k.length!==2)return{valid:!1,message:`${u}字段范围格式错误`};const[N,C]=k.map(Number);if(isNaN(N)||isNaN(C)||N<g||C>v||N>C)return{valid:!1,message:`${u}字段范围必须在${g}-${v}之间，且开始值小于等于结束值`}}else{const k=parseInt(n);if(isNaN(k)||k<g||k>v)return{valid:!1,message:`${u}字段必须在${g}-${v}之间`}}}else if(x.includes("-")){const S=x.split("-");if(S.length!==2)return{valid:!1,message:`${u}字段范围格式错误`};const[n,k]=S.map(Number);if(isNaN(n)||isNaN(k)||n<g||k>v||n>k)return{valid:!1,message:`${u}字段范围必须在${g}-${v}之间，且开始值小于等于结束值`}}else{const S=parseInt(x);if(isNaN(S)||S<g||S>v)return{valid:!1,message:`${u}字段必须在${g}-${v}之间`}}return{valid:!0}}if(m.includes(",")){const w=m.split(",");for(const x of w){const T=x.trim();if(T.includes("-")){const b=T.split("-");if(b.length!==2)return{valid:!1,message:`${u}字段范围格式错误`};const[S,n]=b.map(Number);if(isNaN(S)||isNaN(n)||S<g||n>v||S>n)return{valid:!1,message:`${u}字段范围必须在${g}-${v}之间，且开始值小于等于结束值`}}else{const b=parseInt(T);if(isNaN(b)||b<g||b>v)return{valid:!1,message:`${u}字段必须在${g}-${v}之间`}}}return{valid:!0}}if(m.includes("-")){const w=m.split("-");if(w.length!==2)return{valid:!1,message:`${u}字段范围格式错误`};const[x,T]=w.map(Number);return isNaN(x)||isNaN(T)||x<g||T>v||x>T?{valid:!1,message:`${u}字段范围必须在${g}-${v}之间，且开始值小于等于结束值`}:{valid:!0}}const f=parseInt(m);return isNaN(f)||f<g||f>v?{valid:!1,message:`${u}字段必须在${g}-${v}之间`}:{valid:!0}},d=l(t,0,59,"分钟");if(!d.valid)return d;const y=l(o,0,23,"小时");if(!y.valid)return y;const p=l(a,1,31,"日期");if(!p.valid)return p;const r=l(i,1,12,"月份");if(!r.valid)return r;const h=l(c,0,7,"星期");return h.valid?{valid:!0,message:"Cron表达式格式正确"}:h},parseCronExpression=s=>{const e=validateCronExpression(s);if(cronValidation.value=e,!e.valid){cronNextRuns.value=[];return}const t=s.split(" ").filter(Boolean),[o,a,i,c,l]=t,d=calculateNextRuns(o,a,i,c,l,5);cronNextRuns.value=d},calculateNextRuns=(s,e,t,o,a,i=5)=>{const c=new Date,l=[];let d=new Date(c);d.setMilliseconds(0),d.setSeconds(0),d.setMinutes(d.getMinutes()+1);const y=new Date(c);for(y.setFullYear(y.getFullYear()+1);l.length<i&&d<=y;){const p=parseCronField(s,0,59),r=parseCronField(e,0,23),h=parseCronField(t,1,31),m=parseCronField(o,1,12),g=parseCronField(a,0,7),v=p.includes(d.getMinutes()),u=r.includes(d.getHours()),f=h.includes(d.getDate()),w=m.includes(d.getMonth()+1),x=g.includes(d.getDay()),T=a!=="*",b=t!=="*";let S;if(T&&b?S=f||x:S=f&&x,v&&u&&S&&w){const n=d.toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1});l.push(n),d.setMinutes(d.getMinutes()+1)}else d.setMinutes(d.getMinutes()+1)}return l},saveTask=()=>{var o;if(!taskForm.name){message.warning("请输入任务名称");return}if(taskForm.runType==="daily"&&!taskForm.runTime){message.warning("请选择运行时间");return}if(taskForm.runType==="cron"){if(!taskForm.cronExpression){message.warning("请输入Cron表达式");return}const a=validateCronExpression(taskForm.cronExpression);if(!a.valid){message.warning(a.message);return}}if(taskForm.selectedTokens.length===0){message.warning("请选择至少一个账号");return}if(taskForm.selectedTasks.length===0){message.warning("请选择至少一个任务");return}let s=null;taskForm.runType==="daily"&&taskForm.runTime&&(s=new Date(taskForm.runTime).toLocaleTimeString("zh-CN",{hour12:!1,hour:"2-digit",minute:"2-digit"}));const e={id:((o=editingTask.value)==null?void 0:o.id)||"task_"+Date.now(),name:taskForm.name,runType:taskForm.runType,runTime:s,cronExpression:taskForm.runType==="cron"?taskForm.cronExpression:"",selectedTokens:[...taskForm.selectedTokens],selectedTasks:[...taskForm.selectedTasks],enabled:taskForm.enabled};let t=!editingTask.value;if(editingTask.value){const a=scheduledTasks.value.findIndex(i=>i.id===editingTask.value.id);a!==-1&&(scheduledTasks.value[a]=e)}else scheduledTasks.value.push(e);saveScheduledTasks(),addTaskSaveLog(e,t),showTaskModal.value=!1,message.success("定时任务已保存")},deleteTask=s=>{const e=scheduledTasks.value.find(t=>t.id===s);e&&(scheduledTasks.value=scheduledTasks.value.filter(t=>t.id!==s),saveScheduledTasks(),addLog({time:new Date().toLocaleTimeString(),message:`=== 定时任务 ${e.name} 已删除 ===`,type:"info"}),message.success("定时任务已删除"))},toggleTaskEnabled=(s,e)=>{const t=scheduledTasks.value.find(o=>o.id===s);t&&(t.enabled=e,saveScheduledTasks(),message.success(`定时任务已${e?"启用":"禁用"}`),addLog({time:new Date().toLocaleTimeString(),message:`=== 定时任务 ${t.name} 已${e?"启用":"禁用"} ===`,type:"info"}))},addTaskSaveLog=(s,e)=>{addLog({time:new Date().toLocaleTimeString(),message:`=== ${e?"新增":"修改"}定时任务: ${s.name} ===`,type:"info"}),addLog({time:new Date().toLocaleTimeString(),message:`运行类型: ${s.runType==="daily"?"每天固定时间":"Cron表达式"}`,type:"info"}),addLog({time:new Date().toLocaleTimeString(),message:`运行时间: ${s.runType==="daily"?s.runTime:s.cronExpression}`,type:"info"}),addLog({time:new Date().toLocaleTimeString(),message:`选中账号: ${s.selectedTokens.length} 个`,type:"info"}),addLog({time:new Date().toLocaleTimeString(),message:`选中任务: ${s.selectedTasks.length} 个`,type:"info"}),addLog({time:new Date().toLocaleTimeString(),message:`状态: ${s.enabled?"启用":"禁用"}`,type:"info"})},resetRunType=()=>{taskForm.runType==="daily"?taskForm.cronExpression="":taskForm.runTime=void 0},selectAllTokens=()=>{taskForm.selectedTokens=tokens.value.map(s=>s.id)},deselectAllTokens=()=>{taskForm.selectedTokens=[]},selectAllTasks=()=>{taskForm.selectedTasks=availableTasks.map(s=>s.value)},deselectAllTasks=()=>{taskForm.selectedTasks=[]},legion_storebuygoods=async()=>{await executeBatchTask(selectedTokens.value,async(s,e)=>{addLog({time:new Date().toLocaleTimeString(),message:"发送购买请求...",type:"info"});const t=await tokenStore.sendMessageWithPromise(s,"legion_storebuygoods",{id:6},5e3);t.error?t.error.includes("俱乐部商品购买数量超出上限")?addLog({time:new Date().toLocaleTimeString(),message:"本周已购买过四圣碎片，跳过",type:"info"}):t.error.includes("物品不存在")?addLog({time:new Date().toLocaleTimeString(),message:"盐锭不足或未加入军团，购买失败",type:"error"}):addLog({time:new Date().toLocaleTimeString(),message:`购买失败: ${t.error}`,type:"error"}):addLog({time:new Date().toLocaleTimeString(),message:"购买成功，获得四圣碎片",type:"success"})},{taskName:"购买四圣碎片"})},legionStoreBuySkinCoins=async()=>{await executeBatchTask(selectedTokens.value,async(s,e)=>{addLog({time:new Date().toLocaleTimeString(),message:"发送购买请求...",type:"info"});for(let t=0;t<5&&!shouldStop.value;t++){const o=await tokenStore.sendMessageWithPromise(s,"legion_storebuygoods",{id:1},5e3);if(o.error)if(o.error.includes("俱乐部商品购买数量超出上限")){addLog({time:new Date().toLocaleTimeString(),message:"皮肤币购买已达上限",type:"info"});break}else{addLog({time:new Date().toLocaleTimeString(),message:`购买失败: ${o.error}`,type:"error"});break}addLog({time:new Date().toLocaleTimeString(),message:`成功购买第 ${t+1} 个皮肤币`,type:"success"}),await new Promise(a=>setTimeout(a,500))}},{taskName:"购买皮肤币"})},collection_claimfreereward=async()=>{await executeBatchTask(selectedTokens.value,async(s,e)=>{addLog({time:new Date().toLocaleTimeString(),message:"发送珍宝阁免费领取请求...",type:"info"});const t=await tokenStore.sendMessageWithPromise(s,"collection_claimfreereward",{},5e3);t.error?addLog({time:new Date().toLocaleTimeString(),message:`珍宝阁领取失败: ${t.error}`,type:"error"}):addLog({time:new Date().toLocaleTimeString(),message:"珍宝阁领取成功",type:"success"})},{taskName:"珍宝阁领取"})},store_purchase=async()=>{await executeBatchTask(selectedTokens.value,async(s,e)=>{addLog({time:new Date().toLocaleTimeString(),message:"发送黑市采购请求...",type:"info"});const t=await tokenStore.sendMessageWithPromise(s,"store_purchase",{},5e3);t.error?addLog({time:new Date().toLocaleTimeString(),message:`黑市采购失败: ${t.error}`,type:"error"}):addLog({time:new Date().toLocaleTimeString(),message:"黑市采购成功",type:"success"})},{taskName:"黑市采购"})},parseCronField=(s,e,t)=>{const o=new Set;if(s.includes(",")){const i=s.split(",");for(const c of i)parseCronField(c.trim(),e,t).forEach(d=>o.add(d));return Array.from(o)}if(s==="*"){for(let i=e;i<=t;i++)o.add(i);return Array.from(o)}if(s.includes("/")){const[i,c]=s.split("/"),l=parseInt(c);let d=e,y=t;if(i!=="*")if(i.includes("-")){const[p,r]=i.split("-").map(Number);d=p,y=r}else d=parseInt(i),y=t;for(let p=d;p<=y;p+=l)o.add(p);return Array.from(o)}if(s.includes("-")){const[i,c]=s.split("-").map(Number);for(let l=i;l<=c;l++)o.add(l);return Array.from(o)}const a=parseInt(s);return isNaN(a)||o.add(a),Array.from(o)},calculateNextExecutionTime=s=>{const e=new Date;if(s.runType==="daily"){const[t,o]=s.runTime.split(":").map(Number),a=new Date(e);return a.setHours(t,o,0,0),a<=e&&a.setDate(a.getDate()+1),a}else if(s.runType==="cron"){const t=s.cronExpression.split(" ").filter(Boolean);if(t.length<5)return null;const[o,a,i,c,l]=t,d=parseCronField(o,0,59),y=parseCronField(a,0,23),p=parseCronField(i,1,31),r=parseCronField(c,1,12),h=parseCronField(l,0,7);let m=new Date(e);m.setSeconds(0,0),m.setMinutes(m.getMinutes()+1);const g=new Date(e);for(g.setFullYear(g.getFullYear()+1);m<=g;){const v=m.getMinutes(),u=m.getHours(),f=m.getDate(),w=m.getMonth()+1,x=m.getDay(),T=d.includes(v),b=y.includes(u),S=p.includes(f),n=r.includes(w),k=h.includes(x),N=l!=="*",C=i!=="*";let V;if(N&&C?V=S||k:V=S&&k,T&&b&&V&&n)return m;m.setMinutes(m.getMinutes()+1)}return null}return null},formatTimeDifference=s=>{const e=Math.floor(s/1e3),t=Math.floor(e/60),o=Math.floor(t/60),a=Math.floor(o/24),i=o%24,c=t%60,l=e%60;let d="";return a>0&&(d+=`${a}天`),(i>0||a>0)&&(d+=`${i}小时`),(c>0||i>0||a>0)&&(d+=`${c}分`),d+=`${l}秒`,d},taskCountdowns=ref({}),nextExecutionTimes=ref({}),updateCountdowns=()=>{const s=Date.now();scheduledTasks.value.forEach(e=>{if((!nextExecutionTimes.value[e.id]||nextExecutionTimes.value[e.id]<=s)&&(nextExecutionTimes.value[e.id]=calculateNextExecutionTime(e)),nextExecutionTimes.value[e.id]){const t=nextExecutionTimes.value[e.id]-s;taskCountdowns.value[e.id]={remainingTime:Math.max(0,t),formatted:formatTimeDifference(Math.max(0,t)),isNearExecution:t<5*60*1e3}}})},shortestCountdownTask=computed(()=>{if(scheduledTasks.value.length===0)return null;let s=null,e=1/0;return scheduledTasks.value.forEach(t=>{const o=taskCountdowns.value[t.id];o&&o.remainingTime<e&&(e=o.remainingTime,s={task:t,countdown:o})}),s});let countdownInterval=null;const startCountdown=()=>{countdownInterval&&clearInterval(countdownInterval),updateCountdowns(),countdownInterval=setInterval(updateCountdowns,1e3)};loadScheduledTasks(),watch(scheduledTasks,s=>{nextExecutionTimes.value={},taskCountdowns.value={},updateCountdowns()},{deep:!0}),watch(()=>showTaskModal.value,s=>{s&&!taskForm.runTime&&(taskForm.runTime=void 0)}),onMounted(()=>{scheduleTaskExecution(),startCountdown()}),onBeforeUnmount(()=>{countdownInterval&&(clearInterval(countdownInterval),countdownInterval=null)});const scheduleTaskExecution=()=>{addLog({time:new Date().toLocaleTimeString(),message:"=== 定时任务调度服务已启动 ===",type:"info"});const s=ref(null);let e=null;const t=()=>{if(s.value||(console.error(`[${new Date().toISOString()}] Task scheduler interval is not running, restarting...`),o()),isRunning.value){const i=Date.now()-10*60*1e3;e&&e<i&&(console.error(`[${new Date().toISOString()}] isRunning has been true for more than 10 minutes, resetting to false`),isRunning.value=!1,addLog({time:new Date().toLocaleTimeString(),message:"=== 检测到任务执行超时，已重置isRunning状态 ===",type:"warning"}))}},o=()=>{s.value&&clearInterval(s.value),s.value=setInterval(()=>{try{const a=new Date,i=a.toLocaleTimeString("zh-CN",{hour12:!1,hour:"2-digit",minute:"2-digit",second:"2-digit"}),c=scheduledTasks.value.filter(l=>l.enabled);if(c.length===0)return;c.forEach(l=>{let d=!1,y="";if(l.runType==="daily"){const p=l.runTime,r=a.toLocaleTimeString("zh-CN",{hour12:!1,hour:"2-digit",minute:"2-digit"});d=r===p,y=`currentTime=${r}, taskTime=${p}, match=${d}`}else if(l.runType==="cron")try{const p=l.cronExpression.split(" ").filter(Boolean);if(p.length<5){console.error(`[${new Date().toISOString()}] Invalid cron expression: ${l.cronExpression}, must have at least 5 parts`),addLog({time:i,message:`=== 定时任务 ${l.name} 的Cron表达式无效: ${l.cronExpression}，必须包含至少5个字段 ===`,type:"error"});return}const[r,h,m,g,v]=p,u=parseCronField(r,0,59),f=parseCronField(h,0,23),w=parseCronField(m,1,31),x=parseCronField(g,1,12),T=parseCronField(v,0,7),b=u.includes(a.getMinutes()),S=f.includes(a.getHours()),n=w.includes(a.getDate()),k=x.includes(a.getMonth()+1),N=T.includes(a.getDay());d=b&&S&&n&&k&&N,y=`minute=${b}, hour=${S}, dayOfMonth=${n}, month=${k}, dayOfWeek=${N}`}catch(p){console.error(`[${new Date().toISOString()}] Error parsing cron expression ${l.cronExpression}:`,p),addLog({time:i,message:`=== 解析定时任务 ${l.name} 的Cron表达式失败: ${p.message} ===`,type:"error"});return}if(d){const p=`${l.id}_${a.getDate()}_${a.getHours()}_${a.getMinutes()}`;localStorage.getItem(`lastTaskExecution_${l.id}`)!==p?(localStorage.setItem(`lastTaskExecution_${l.id}`,p),e=Date.now(),executeScheduledTask(l)):addLog({time:i,message:`=== 任务 ${l.name} 本分钟内已执行，跳过 ===`,type:"info"})}})}catch(a){console.error(`[${new Date().toISOString()}] Error in task scheduler:`,a),addLog({time:new Date().toLocaleTimeString(),message:`=== 定时任务调度服务发生错误: ${a.message} ===`,type:"error"})}},1e4)};o(),setInterval(t,5*60*1e3),t(),onBeforeUnmount(()=>{s.value&&(clearInterval(s.value),s.value=null),addLog({time:new Date().toLocaleTimeString(),message:"=== 定时任务调度服务已停止 ===",type:"info"})})},executeScheduledTask=async task=>{var s;addLog({time:new Date().toLocaleTimeString(),message:`=== 开始执行定时任务: ${task.name} ===`,type:"info"});try{selectedTokens.value=[...task.connectedTokens||task.selectedTokens];for(const taskName of task.selectedTasks){if(shouldStop.value)break;addLog({time:new Date().toLocaleTimeString(),message:`执行任务: ${((s=availableTasks.find(e=>e.value===taskName))==null?void 0:s.label)||taskName}`,type:"info"});const taskFunction=eval(taskName);typeof taskFunction=="function"?["batchOpenBox","batchFish","batchRecruit","batchLegacyGiftSendEnhanced"].includes(taskName)?await taskFunction(!0):await taskFunction():addLog({time:new Date().toLocaleTimeString(),message:`任务函数不存在: ${taskName}`,type:"error"})}addLog({time:new Date().toLocaleTimeString(),message:`=== 定时任务执行完成: ${task.name} ===`,type:"success"})}catch(e){addLog({time:new Date().toLocaleTimeString(),message:`=== 定时任务执行失败: ${e.message} ===`,type:"error"}),console.error(`[${new Date().toISOString()}] Error executing scheduled task ${task.name}:`,e)}},boxTypeOptions=[{label:"木质宝箱",value:2001},{label:"青铜宝箱",value:2002},{label:"黄金宝箱",value:2003},{label:"铂金宝箱",value:2004}],fishTypeOptions=[{label:"普通鱼竿",value:1},{label:"黄金鱼竿",value:2}],openHelperModal=s=>{helperType.value=s,showHelperModal.value=!0},clearRecipientError=()=>{recipientIdError.value=""},handleAvatarLoad=()=>{isAvatarLoading.value=!1,avatarLoadError.value=!1},handleAvatarError=()=>{isAvatarLoading.value=!1,avatarLoadError.value=!0},resetAvatarState=()=>{isAvatarLoading.value=!0,avatarLoadError.value=!1},queryRecipientInfo=async()=>{var o,a,i,c,l,d,y,p;if(!recipientIdInput.value||recipientIdInput.value===""){recipientIdError.value="请输入接收者ID";return}const s=Number(recipientIdInput.value);if(!Number.isInteger(s)||s<=0){recipientIdError.value="请输入有效的数字ID";return}if(selectedTokens.value.length===0){recipientIdError.value="请先选择要操作的角色";return}isQueryingRecipient.value=!0,recipientIdError.value="",recipientInfo.value=null,resetAvatarState();const e=selectedTokens.value[0],t=tokens.value.find(r=>r.id===e);addLog({time:new Date().toLocaleTimeString(),message:`=== 开始查询接收者信息: 使用账号 ${t.name} (ID: ${e}) ===`,type:"info"});try{addLog({time:new Date().toLocaleTimeString(),message:"正在建立WebSocket连接...",type:"info"}),await ensureConnection(e),addLog({time:new Date().toLocaleTimeString(),message:"WebSocket连接成功",type:"success"}),addLog({time:new Date().toLocaleTimeString(),message:`正在发送查询命令，接收者ID: ${s}`,type:"info"});const r=await tokenStore.sendMessageWithPromise(e,"rank_getroleinfo",{bottleType:0,includeBottleTeam:!1,isSearch:!1,roleId:s},1e4);addLog({time:new Date().toLocaleTimeString(),message:"查询命令发送成功，正在处理响应...",type:"info"}),console.log("rank_getroleinfo 响应结果:",r);const h=(r==null?void 0:r.role)||(r==null?void 0:r.roleInfo);if(h){recipientInfo.value={roleId:h.roleId||((o=h.role)==null?void 0:o.roleId),name:h.name||((a=h.role)==null?void 0:a.name),avatarUrl:((i=r==null?void 0:r.roleInfo)==null?void 0:i.headImg)||(h==null?void 0:h.headImg)||((c=h==null?void 0:h.role)==null?void 0:c.headImg)||"",power:function(g){return(g/1e8).toFixed(2)}(h.power||((l=h.role)==null?void 0:l.power)||0),powerUnit:"亿",serverName:h.serverName||((d=h.role)==null?void 0:d.serverName)||"",legionName:((y=r==null?void 0:r.legionInfo)==null?void 0:y.name)||"",legionId:((p=r==null?void 0:r.legionInfo)==null?void 0:p.id)||0};const m=recipientInfo.value.name||"未知角色";addLog({time:new Date().toLocaleTimeString(),message:`=== 查询成功: 找到角色 ${m} (ID: ${recipientInfo.value.roleId})，战力: ${recipientInfo.value.power}${recipientInfo.value.powerUnit} ===`,type:"success"}),message.success("查询成功")}else{const m="未找到该角色信息";recipientIdError.value=m,addLog({time:new Date().toLocaleTimeString(),message:`=== 查询失败: ${m} ===`,type:"error"}),message.error(m)}}catch(r){console.error("查询接收者信息失败:",r);let h="查询失败",m="error";r.message.includes("连接失败")?h="WebSocket连接失败，请检查网络或账号状态":r.message.includes("timeout")||r.message.includes("超时")?(h="查询超时，请稍后重试",m="warning"):r.message.includes("200160")?h="功法系统未开启":h=`查询失败: ${r.message}`,recipientIdError.value=h,addLog({time:new Date().toLocaleTimeString(),message:`=== ${h} ===`,type:m}),message.error(h)}finally{isQueryingRecipient.value=!1,addLog({time:new Date().toLocaleTimeString(),message:"=== 查询操作完成 ===",type:"info"})}},confirmLegacyGift=async()=>{if(!recipientIdInput.value||!recipientInfo.value){message.error("请先查询并确认接收者信息");return}if(!securityPassword.value){message.error("请输入安全密码");return}await batchLegacyGiftSendEnhanced(),showLegacyGiftModal.value=!1,securityPassword.value=""},executeHelper=()=>{if(helperSettings.count%10!==0||helperSettings.count<10){message.warning("消耗数量必须是10的整数倍，最小为10");return}showHelperModal.value=!1,helperType.value==="box"?batchOpenBox():helperType.value==="fish"?batchFish():helperType.value==="recruit"&&batchRecruit()},formationOptions=[1,2,3,4,5,6].map(s=>({label:`阵容${s}`,value:s})),bossTimesOptions=[0,1,2,3,4].map(s=>({label:`${s}次`,value:s})),loadSettings=s=>{try{const e=localStorage.getItem(`daily-settings:${s}`),t={arenaFormation:1,bossFormation:1,bossTimes:2,claimBottle:!0,payRecruit:!0,openBox:!0,arenaEnable:!0,claimHangUp:!0,claimEmail:!0,blackMarketPurchase:!0};return e?{...t,...JSON.parse(e)}:t}catch(e){return console.error("Failed to load settings:",e),null}},openSettings=s=>{currentSettingsTokenId.value=s.id,currentSettingsTokenName.value=s.name;const e=loadSettings(s.id);Object.assign(currentSettings,e),showSettingsModal.value=!0},saveSettings=()=>{currentSettingsTokenId.value&&(localStorage.setItem(`daily-settings:${currentSettingsTokenId.value}`,JSON.stringify(currentSettings)),message.success(`已保存 ${currentSettingsTokenName.value} 的设置`),showSettingsModal.value=!1)},ensureConnectionWithCleanup=async(s,e=5)=>{const t=tokens.value.find(o=>o.id===s);addLog({time:new Date().toLocaleTimeString(),message:`[连接池] 获取连接: ${(t==null?void 0:t.name)||s}`,type:"info"});try{if(await connectionPool.acquire(s,e))return addLog({time:new Date().toLocaleTimeString(),message:`[连接池] 连接已就绪: ${(t==null?void 0:t.name)||s}`,type:"success"}),!0;throw new Error("获取连接失败")}catch(o){throw addLog({time:new Date().toLocaleTimeString(),message:`[连接池] 连接失败: ${o.message}`,type:"error"}),o}},safeReleaseConnection=async(s,e=!0)=>{try{await connectionPool.release(s,e)}catch(t){console.error(`[连接池] 释放连接失败: ${s}`,t)}},executeBatchTask=async(s,e,t={})=>{var v;const{taskName:o="批量任务",priority:a=5,delayBetween:i=batchSettings.delayBetweenTasks,autoDisconnect:c=!0,useConnectionPool:l=!0,retryOnError:d=!0,maxRetries:y=batchSettings.taskRetryCount}=t;if(s.length===0)return message.warning("请先选择账号"),{success:[],failed:[],skipped:[]};connectionPool&&(connectionPool.maxConnections=batchSettings.maxConnections,connectionPool.connectionTimeout=batchSettings.connectionTimeout),lastTaskContext.value={taskFn:e,options:t},isRunning.value=!0,shouldStop.value=!1,t.isRetry||!1?s.forEach(u=>{const f=batchExecutionStats.value.failedTokens.findIndex(w=>w.id===u);f!==-1&&(batchExecutionStats.value.failedTokens.splice(f,1),batchExecutionStats.value.failedCount--)}):batchExecutionStats.value={successCount:0,failedCount:0,totalCount:s.length,failedTokens:[]},s.forEach(u=>{tokenStatus.value[u]="waiting"});const r={success:[],failed:[],skipped:[]};for(const u of s){if(shouldStop.value){r.skipped.push(u),addLog({time:new Date().toLocaleTimeString(),message:`跳过: ${(v=tokenStore.gameTokens.find(T=>T.id===u))==null?void 0:v.name}`,type:"warning"});continue}currentRunningTokenId.value=u,tokenStatus.value[u]="running",currentProgress.value=0;const f=tokens.value.find(T=>T.id===u);let w=d?y:0,x=!1;for(;w>=0&&!x;)try{addLog({time:new Date().toLocaleTimeString(),message:`=== 开始${o}: ${(f==null?void 0:f.name)||u} ===`,type:"info"}),l?await ensureConnectionWithCleanup(u,a):(await tokenStore.connectWebSocket(u),await new Promise(T=>setTimeout(T,2e3))),await e(u,f),x=!0,tokenStatus.value[u]="completed",r.success.push(u),batchExecutionStats.value.successCount++,addLog({time:new Date().toLocaleTimeString(),message:`=== ${(f==null?void 0:f.name)||u} 完成 ===`,type:"success"})}catch(T){console.error(`${o}执行失败:`,T);const b=T.message||String(T);if(b.includes("200020")||b.includes("重启游戏"))addLog({time:new Date().toLocaleTimeString(),message:`${f==null?void 0:f.name} 遇到致命错误 (200020)，停止重试: ${b}`,type:"error"}),w=-1;else if(w>0){const n=y-w+1;addLog({time:new Date().toLocaleTimeString(),message:`${f==null?void 0:f.name} 失败，准备第 ${n}/${y} 次重试: ${b}`,type:"warning"}),await new Promise(k=>setTimeout(k,3e3)),w--;continue}else addLog({time:new Date().toLocaleTimeString(),message:`${f==null?void 0:f.name} 最终执行失败: ${b}`,type:"error"}),w=-1;tokenStatus.value[u]="failed",r.failed.push(u),batchExecutionStats.value.failedCount++,batchExecutionStats.value.failedTokens.push({id:u,name:(f==null?void 0:f.name)||u,taskName:o})}finally{l&&c&&(await safeReleaseConnection(u,!0),await new Promise(T=>setTimeout(T,500)))}currentProgress.value=100,await new Promise(T=>setTimeout(T,i))}isRunning.value=!1,currentRunningTokenId.value=null;const h=r.success.length,m=r.failed.length,g=r.skipped.length;return message.success(`${o}完成: 成功${h}个, 失败${m}个${g>0?`, 跳过${g}个`:""}`),r},currentRunningTokenId=ref(null),currentProgress=ref(0),logs=ref([]),logContainer=ref(null),autoScrollLog=ref(!0),filterErrorsOnly=ref(!1),batchExecutionStats=ref({successCount:0,failedCount:0,totalCount:0,failedTokens:[]}),lastTaskContext=ref(null),errorCount=computed(()=>logs.value.filter(s=>s.type==="error").length),filteredLogs=computed(()=>filterErrorsOnly.value?logs.value.filter(s=>s.type==="error"):logs.value),currentRunningTokenName=computed(()=>{const s=tokens.value.find(e=>e.id===currentRunningTokenId.value);return s?s.name:""}),retryTaskForToken=async s=>{var a;if(!lastTaskContext.value){message.warning("没有可补做的任务上下文");return}const{taskFn:e,options:t}=lastTaskContext.value,o=t.taskName||"补做任务";addLog({time:new Date().toLocaleTimeString(),message:`>>> 开始为 ${(a=tokenStore.gameTokens.find(i=>i.id===s))==null?void 0:a.name} 补做: ${o}`,type:"info"}),await executeBatchTask([s],e,{...t,taskName:`补做-${o}`,isRetry:!0})},isAllSelected=computed(()=>selectedTokens.value.length===tokens.value.length&&tokens.value.length>0),isIndeterminate=computed(()=>selectedTokens.value.length>0&&selectedTokens.value.length<tokens.value.length),handleSelectAll=s=>{s?selectedTokens.value=tokens.value.map(e=>e.id):selectedTokens.value=[]},getStatusType=s=>{const e=tokenStatus.value[s];return e==="completed"?"success":e==="failed"?"error":e==="running"?"info":"default"},getStatusText=s=>{const e=tokenStatus.value[s];return e==="completed"?"已完成":e==="failed"?"失败":e==="running"?"执行中":"等待中"},pickArenaTargetId=s=>{var t,o,a,i,c;const e=((t=s==null?void 0:s.rankList)==null?void 0:t[0])||((o=s==null?void 0:s.roleList)==null?void 0:o[0])||((a=s==null?void 0:s.targets)==null?void 0:a[0])||((i=s==null?void 0:s.targetList)==null?void 0:i[0])||((c=s==null?void 0:s.list)==null?void 0:c[0]);return e!=null&&e.roleId?e.roleId:e!=null&&e.id?e.id:(s==null?void 0:s.roleId)||(s==null?void 0:s.id)},getTodayStartSec=()=>{const s=new Date;return s.setHours(0,0,0,0),Math.floor(s.getTime()/1e3)},isTodayAvailable=s=>!s||typeof s!="number"?!0:s<getTodayStartSec(),calculateMonthProgress=()=>{const s=new Date,e=new Date(s.getFullYear(),s.getMonth()+1,0).getDate(),t=s.getDate();return Math.min(1,Math.max(0,t/e))},addLog=s=>{logs.value.push(s),nextTick(()=>{logContainer.value&&autoScrollLog.value&&(logContainer.value.scrollTop=logContainer.value.scrollHeight)})},handleScroll=()=>{if(!logContainer.value)return;const{scrollTop:s,scrollHeight:e,clientHeight:t}=logContainer.value;e-s-t<50?autoScrollLog.value||(autoScrollLog.value=!0):autoScrollLog.value&&(autoScrollLog.value=!1)};watch(autoScrollLog,s=>{s&&logContainer.value&&nextTick(()=>{logContainer.value.scrollTop=logContainer.value.scrollHeight})});const copyLogs=()=>{if(logs.value.length===0){message.warning("没有可复制的日志");return}const s=logs.value.map(e=>`${e.time} ${e.message}`).join(`
`);navigator.clipboard.writeText(s).then(()=>{message.success("日志已复制到剪贴板")}).catch(e=>{message.error("复制日志失败: "+e.message)})},claimHangUpRewards=async()=>{await executeBatchTask(selectedTokens.value,async(s,e)=>{addLog({time:new Date().toLocaleTimeString(),message:"领取挂机奖励",type:"info"}),await tokenStore.sendMessageWithPromise(s,"system_claimhangupreward",{},5e3),await new Promise(t=>setTimeout(t,500));for(let t=0;t<4;t++)addLog({time:new Date().toLocaleTimeString(),message:`挂机加钟 ${t+1}/4`,type:"info"}),await tokenStore.sendMessageWithPromise(s,"system_mysharecallback",{isSkipShareCard:!0,type:2},5e3),await new Promise(o=>setTimeout(o,500))},{taskName:"领取挂机"})},resetBottles=async()=>{await executeBatchTask(selectedTokens.value,async(s,e)=>{addLog({time:new Date().toLocaleTimeString(),message:"停止计时...",type:"info"}),await tokenStore.sendMessageWithPromise(s,"bottlehelper_stop",{},5e3),await new Promise(t=>setTimeout(t,500)),addLog({time:new Date().toLocaleTimeString(),message:"开始计时...",type:"info"}),await tokenStore.sendMessageWithPromise(s,"bottlehelper_start",{},5e3)},{taskName:"重置罐子"})},batchbaoku45=async()=>{await executeBatchTask(selectedTokens.value,async(s,e)=>{const o=(await tokenStore.sendMessageWithPromise(s,"bosstower_getinfo",{},5e3)).bossTower.towerId;if(o>=4&&o<=5)for(let a=0;a<2&&!shouldStop.value;a++)await tokenStore.sendMessageWithPromise(s,"bosstower_startboss",{},5e3),await new Promise(i=>setTimeout(i,500))},{taskName:"一键宝库4-5"})},batchmengjing=async()=>{await executeBatchTask(selectedTokens.value,async(s,e)=>{const t={0:107},o=new Date().getDay();[0,1,3,4].includes(o)?(await tokenStore.sendMessageWithPromise(s,"dungeon_selecthero",{battleTeam:t},5e3),await new Promise(a=>setTimeout(a,500))):addLog({time:new Date().toLocaleTimeString(),message:"当前未在开放时间",type:"warning"})},{taskName:"咸王梦境"})},batchlingguanzi=async()=>{await executeBatchTask(selectedTokens.value,async(s,e)=>{await tokenStore.sendMessageWithPromise(s,"bottlehelper_claim",{},5e3),await new Promise(t=>setTimeout(t,500))},{taskName:"领取盐罐"})},batchclubsign=async()=>{await executeBatchTask(selectedTokens.value,async(s,e)=>{addLog({time:new Date().toLocaleTimeString(),message:`开始一键俱乐部签到: ${e.name}`,type:"info"}),await tokenStore.sendMessageWithPromise(s,"legion_dailysign",{},5e3),await new Promise(t=>setTimeout(t,500))},{taskName:"俱乐部签到"})},batcharenafight=async()=>{await executeBatchTask(selectedTokens.value,async(s,e)=>{for(let t=0;t<3&&!shouldStop.value;t++){await tokenStore.sendMessageWithPromise(s,"arena_startarea",{});let o;try{o=await tokenStore.sendMessageWithPromise(s,"arena_getareatarget",{},5e3)}catch(i){addLog({time:new Date().toLocaleTimeString(),message:`获取竞技场目标失败: ${i.message}`,type:"error"});break}const a=pickArenaTargetId(o);if(!a){addLog({time:new Date().toLocaleTimeString(),message:"未找到可用的竞技场目标",type:"warning"});break}await tokenStore.sendMessageWithPromise(s,"fight_startareaarena",{targetId:a},5e3),addLog({time:new Date().toLocaleTimeString(),message:`竞技场战斗 ${t+1}/3`,type:"info"}),await new Promise(i=>setTimeout(i,500))}},{taskName:"竞技场战斗"})},batchAddHangUpTime=async()=>{await executeBatchTask(selectedTokens.value,async(s,e)=>{for(let t=0;t<4&&!shouldStop.value;t++)addLog({time:new Date().toLocaleTimeString(),message:`执行加钟 ${t+1}/4`,type:"info"}),await tokenStore.sendMessageWithPromise(s,"system_mysharecallback",{isSkipShareCard:!0,type:2},5e3),await new Promise(o=>setTimeout(o,500))},{taskName:"批量加钟"})},batchbaoku13=async()=>{await executeBatchTask(selectedTokens.value,async(s,e)=>{const o=(await tokenStore.sendMessageWithPromise(s,"bosstower_getinfo",{},5e3)).bossTower.towerId;if(o>=1&&o<=3){for(let a=0;a<2&&!shouldStop.value;a++)await tokenStore.sendMessageWithPromise(s,"bosstower_startboss",{},5e3),await new Promise(i=>setTimeout(i,500));for(let a=0;a<9&&!shouldStop.value;a++)await tokenStore.sendMessageWithPromise(s,"bosstower_startbox",{},5e3),await new Promise(i=>setTimeout(i,500))}},{taskName:"一键宝库1-3"})},climbTower=async()=>{await executeBatchTask(selectedTokens.value,async(s,e)=>{var l,d,y,p,r,h,m,g,v;await tokenStore.sendMessageWithPromise(s,"tower_getinfo",{},5e3).catch(()=>{});let t=await tokenStore.sendGetRoleInfo(s),o=((d=(l=t==null?void 0:t.role)==null?void 0:l.tower)==null?void 0:d.energy)||0;addLog({time:new Date().toLocaleTimeString(),message:`初始体力: ${o}`,type:"info"});let a=0;const i=100;let c=0;for(;o>0&&a<i&&!shouldStop.value;)try{await tokenStore.sendMessageWithPromise(s,"fight_starttower",{},5e3),a++,c=0,addLog({time:new Date().toLocaleTimeString(),message:`爬塔第 ${a} 次`,type:"info"}),await new Promise(f=>setTimeout(f,2e3)),tokenStore.sendMessage(s,"tower_getinfo"),t=await tokenStore.sendGetRoleInfo(s);const u=(y=tokenStore.gameData)==null?void 0:y.roleInfo;o=((r=(p=u==null?void 0:u.role)==null?void 0:p.tower)==null?void 0:r.energy)??((m=(h=t==null?void 0:t.role)==null?void 0:h.tower)==null?void 0:m.energy)??0}catch(u){if(u.message&&u.message.includes("200400")){addLog({time:new Date().toLocaleTimeString(),message:"爬塔次数已用完 (200400)",type:"info"});break}if(c++,addLog({time:new Date().toLocaleTimeString(),message:`战斗出错: ${u.message} (重试 ${c}/3)`,type:"warning"}),c>=3)break;await new Promise(f=>setTimeout(f,2e3));try{t=await tokenStore.sendGetRoleInfo(s),o=((v=(g=t==null?void 0:t.role)==null?void 0:g.tower)==null?void 0:v.energy)||0}catch{}}},{taskName:"批量爬塔"})},batchStudy=async()=>{addLog({time:new Date().toLocaleTimeString(),message:"正在加载题库...",type:"info"}),await preloadQuestions(),await executeBatchTask(selectedTokens.value,async(s,e)=>{addLog({time:new Date().toLocaleTimeString(),message:`=== 开始答题: ${e.name} ===`,type:"info"}),tokenStore.gameData.studyStatus={isAnswering:!1,questionCount:0,answeredCount:0,status:"",timestamp:null},await tokenStore.sendMessageWithPromise(s,"study_startgame",{},5e3);let t=90,o=!1,a="";for(;t>0&&!shouldStop.value;){const i=tokenStore.gameData.studyStatus;if(i.status!==a&&(a=i.status,i.status==="answering"?addLog({time:new Date().toLocaleTimeString(),message:"开始答题...",type:"info"}):i.status==="claiming_rewards"&&addLog({time:new Date().toLocaleTimeString(),message:"正在领取奖励...",type:"info"})),i.status==="completed"){o=!0;break}await new Promise(c=>setTimeout(c,1e3)),t--}if(o)addLog({time:new Date().toLocaleTimeString(),message:`=== ${e.name} 答题完成 ===`,type:"success"});else if(!shouldStop.value)throw new Error("答题超时或未开始")},{taskName:"批量答题"})},batchTopUpFish=async()=>{await executeBatchTask(selectedTokens.value,async(s,e)=>{var k,N,C,V,L,D,$,M,P,E;addLog({time:new Date().toLocaleTimeString(),message:"获取月度任务进度...",type:"info"});const t=await tokenStore.sendMessageWithPromise(s,"activity_get",{},1e4),o=(t==null?void 0:t.activity)||((k=t==null?void 0:t.body)==null?void 0:k.activity)||t;if(!o)throw new Error("获取月度任务进度失败");const a=o.myMonthInfo||{},i=Number(((N=a==null?void 0:a["2"])==null?void 0:N.num)||0),c=calculateMonthProgress(),l=new Date,d=new Date(l.getFullYear(),l.getMonth()+1,0).getDate(),y=l.getDate(),r=Math.max(0,d-y)===0?FISH_TARGET:Math.min(FISH_TARGET,Math.ceil(c*FISH_TARGET)),h=Math.max(0,r-i);if(addLog({time:new Date().toLocaleTimeString(),message:`当前进度: ${i}/${FISH_TARGET}，需要补齐: ${h}次`,type:"info"}),h<=0){addLog({time:new Date().toLocaleTimeString(),message:"当前进度已达标，无需补齐",type:"success"});return}addLog({time:new Date().toLocaleTimeString(),message:"开始执行钓鱼补齐...",type:"info"});let m=(V=(C=tokenStore.gameData)==null?void 0:C.roleInfo)==null?void 0:V.role;if(!m){const _=await tokenStore.sendGetRoleInfo(s);m=_==null?void 0:_.role}let g=0;const v=Number(((L=m==null?void 0:m.statisticsTime)==null?void 0:L["artifact:normal:lottery:time"])||0);if(isTodayAvailable(v)){addLog({time:new Date().toLocaleTimeString(),message:"检测到今日免费钓鱼次数，开始消耗 3 次",type:"info"});for(let _=0;_<3&&h>g&&!shouldStop.value;_++)await tokenStore.sendMessageWithPromise(s,"artifact_lottery",{lotteryNumber:1,newFree:!0,type:1},8e3),g++,await new Promise(B=>setTimeout(B,500))}const u=await tokenStore.sendMessageWithPromise(s,"activity_get",{},1e4),w=((u==null?void 0:u.activity)||((D=u==null?void 0:u.body)==null?void 0:D.activity)||u).myMonthInfo||{},x=Number((($=w==null?void 0:w["2"])==null?void 0:$.num)||0);let T=Math.max(0,r-x);if(addLog({time:new Date().toLocaleTimeString(),message:`免费次数后进度: ${x}/${FISH_TARGET}，还需补齐: ${T}次`,type:"info"}),T<=0)return;for(addLog({time:new Date().toLocaleTimeString(),message:`开始付费钓鱼补齐: 共需 ${T} 次`,type:"info"});T>0&&!shouldStop.value;){const _=Math.min(10,T);await tokenStore.sendMessageWithPromise(s,"artifact_lottery",{lotteryNumber:_,newFree:!0,type:1},12e3),addLog({time:new Date().toLocaleTimeString(),message:`完成 ${_} 次付费钓鱼`,type:"info"}),T-=_,await new Promise(B=>setTimeout(B,800))}const b=await tokenStore.sendMessageWithPromise(s,"activity_get",{},1e4),S=(b==null?void 0:b.activity)||((M=b==null?void 0:b.body)==null?void 0:M.activity)||b,n=Number(((E=(P=S.myMonthInfo)==null?void 0:P["2"])==null?void 0:E.num)||0);addLog({time:new Date().toLocaleTimeString(),message:`最终进度: ${n}/${FISH_TARGET}`,type:n>=r?"success":"warning"})},{taskName:"钓鱼补齐"})},batchTopUpArena=async()=>{await executeBatchTask(selectedTokens.value,async(s,e)=>{var m,g,v,u,f;addLog({time:new Date().toLocaleTimeString(),message:"获取月度任务进度...",type:"info"});const t=await tokenStore.sendMessageWithPromise(s,"activity_get",{},1e4),o=(t==null?void 0:t.activity)||((m=t==null?void 0:t.body)==null?void 0:m.activity)||t;if(!o)throw new Error("获取月度任务进度失败");const a=o.myMonthInfo||{},i=Number(((g=a==null?void 0:a["1"])==null?void 0:g.num)||0),c=calculateMonthProgress(),l=Math.min(ARENA_TARGET,Math.ceil(c*ARENA_TARGET)),d=Math.max(0,l-i);if(addLog({time:new Date().toLocaleTimeString(),message:`当前进度: ${i}/${ARENA_TARGET}，需要补齐: ${d}次`,type:"info"}),d<=0){addLog({time:new Date().toLocaleTimeString(),message:"当前进度已达标，无需补齐",type:"success"});return}addLog({time:new Date().toLocaleTimeString(),message:`开始执行竞技场补齐: 共需 ${d} 次`,type:"info"});let y=d;for(;y>0&&!shouldStop.value;){await tokenStore.sendMessageWithPromise(s,"arena_startarea",{});const w=await tokenStore.sendMessageWithPromise(s,"arena_getareatarget",{},5e3),x=pickArenaTargetId(w);if(!x)break;await tokenStore.sendMessageWithPromise(s,"fight_startareaarena",{targetId:x},5e3),y--,addLog({time:new Date().toLocaleTimeString(),message:`竞技场补齐中... 剩余 ${y} 次`,type:"info"}),await new Promise(T=>setTimeout(T,500))}const p=await tokenStore.sendMessageWithPromise(s,"activity_get",{},1e4),r=(p==null?void 0:p.activity)||((v=p==null?void 0:p.body)==null?void 0:v.activity)||p,h=Number(((f=(u=r.myMonthInfo)==null?void 0:u["1"])==null?void 0:f.num)||0);addLog({time:new Date().toLocaleTimeString(),message:`最终进度: ${h}/${ARENA_TARGET}`,type:h>=l?"success":"warning"})},{taskName:"竞技场补齐"})},normalizeCars=s=>{const e=s||{},t=e.body||e,o=t.roleCar||t.rolecar||{},a=o.carDataMap||o.cardatamap;if(a&&typeof a=="object")return Object.entries(a).map(([c,l],d)=>({key:d,id:c,...l||{}}));let i=t.cars||t.list||t.data||t.carList||t.vehicles||[];return!Array.isArray(i)&&typeof i=="object"&&i!==null&&(i=Object.values(i)),Array.isArray(t)&&i.length===0&&(i=t),(Array.isArray(i)?i:[]).map((c,l)=>({key:l,...c}))},gradeLabel=s=>({1:"绿·普通",2:"蓝·稀有",3:"紫·史诗",4:"橙·传说",5:"红·神话",6:"金·传奇"})[s]||"未知",isBigPrize=s=>{const e=[{type:3,itemId:3201,value:10},{type:3,itemId:1001,value:10},{type:3,itemId:1022,value:2e3},{type:2,itemId:0,value:2e3},{type:3,itemId:1023,value:5},{type:3,itemId:1022,value:2500},{type:3,itemId:1001,value:12}];return Array.isArray(s)?e.some(t=>s.find(o=>o.type===t.type&&o.itemId===t.itemId&&Number(o.value||0)>=t.value)):!1},countRacingRefreshTickets=s=>Array.isArray(s)?s.reduce((e,t)=>e+(t.type===3&&t.itemId===35002?Number(t.value||0):0),0):0,shouldSendCar=(s,e)=>{const t=Number((s==null?void 0:s.color)||0),o=Array.isArray(s==null?void 0:s.rewards)?s.rewards:[],a=countRacingRefreshTickets(o);return e>=6?t>=5||a>=4||isBigPrize(o):t>=4||a>=2||isBigPrize(o)},canClaim=s=>{const e=Number((s==null?void 0:s.sendAt)||0);if(!e)return!1;const t=e<1e12?e*1e3:e;return Date.now()-t>=FOUR_HOURS_MS},batchSmartSendCar=async()=>{await executeBatchTask(selectedTokens.value,async(s,e)=>{var i,c,l,d,y,p;addLog({time:new Date().toLocaleTimeString(),message:"获取车辆信息...",type:"info"});const t=await tokenStore.sendMessageWithPromise(s,"car_getrolecar",{},1e4);let o=normalizeCars((t==null?void 0:t.body)??t),a=0;try{const r=await tokenStore.sendMessageWithPromise(s,"role_getroleinfo",{},1e4);a=Number(((l=(c=(i=r==null?void 0:r.role)==null?void 0:i.items)==null?void 0:c[35002])==null?void 0:l.quantity)||0),addLog({time:new Date().toLocaleTimeString(),message:`剩余车票: ${a}`,type:"info"})}catch{}for(const r of o){if(shouldStop.value)break;if(Number(r.sendAt||0)===0){if(shouldSendCar(r,a)){addLog({time:new Date().toLocaleTimeString(),message:`车辆[${gradeLabel(r.color)}]满足条件，直接发车`,type:"info"}),await tokenStore.sendMessageWithPromise(s,"car_send",{carId:String(r.id),helperId:0,text:"",isUpgrade:!1},1e4),await new Promise(h=>setTimeout(h,500));continue}for(;!shouldStop.value;){const h=Number(r.refreshCount??0)===0;if(!(h||a>=6)){addLog({time:new Date().toLocaleTimeString(),message:`车辆[${gradeLabel(r.color)}]不满足条件且无刷新次数，直接发车`,type:"warning"}),await tokenStore.sendMessageWithPromise(s,"car_send",{carId:String(r.id),helperId:0,text:"",isUpgrade:!1},1e4),await new Promise(u=>setTimeout(u,500));break}addLog({time:new Date().toLocaleTimeString(),message:`刷新车辆[${gradeLabel(r.color)}]...`,type:"info"});const g=await tokenStore.sendMessageWithPromise(s,"car_refresh",{carId:String(r.id)},1e4);h||a--;const v=(((y=(d=g==null?void 0:g.body)==null?void 0:d.roleCar)==null?void 0:y.carDataMap)||((p=g==null?void 0:g.roleCar)==null?void 0:p.carDataMap)||{})[r.id];if(!v)break;if(shouldSendCar(v,a)){addLog({time:new Date().toLocaleTimeString(),message:`刷新后车辆[${gradeLabel(v.color)}]满足条件，发车`,type:"success"}),await tokenStore.sendMessageWithPromise(s,"car_send",{carId:String(r.id),helperId:0,text:"",isUpgrade:!1},1e4),await new Promise(u=>setTimeout(u,500));break}await new Promise(u=>setTimeout(u,1e3))}}}},{taskName:"智能发车"})},batchClaimCars=async()=>{await executeBatchTask(selectedTokens.value,async(s,e)=>{addLog({time:new Date().toLocaleTimeString(),message:"获取车辆信息...",type:"info"});const t=await tokenStore.sendMessageWithPromise(s,"car_getrolecar",{},1e4);let o=normalizeCars((t==null?void 0:t.body)??t);for(const a of o){if(shouldStop.value)break;Number(a.sendAt||0)!==0&&canClaim(a)&&(addLog({time:new Date().toLocaleTimeString(),message:`收车: [${gradeLabel(a.color)}]`,type:"info"}),await tokenStore.sendMessageWithPromise(s,"car_claim",{carId:String(a.id)},1e4),await new Promise(i=>setTimeout(i,500)))}},{taskName:"一键收车"})},startBatch=async()=>{tokenStore.startTask(),tokenStore.closeAllConnectionsAfterTasks(),await executeBatchTask(selectedTokens.value,async(s,e)=>{let t=0;const o=1;let a=!1;for(;t<=o&&!a;)try{t>0&&addLog({time:new Date().toLocaleTimeString(),message:`尝试重试: ${e.name} (第${t}次)`,type:"info"}),await runner.run(s,{onLog:i=>addLog(i),onProgress:i=>{currentProgress.value=i}}),a=!0,tokenStatus.value[s]="completed",addLog({time:new Date().toLocaleTimeString(),message:`=== ${e.name} 执行完成 ===`,type:"success"})}catch(i){console.error(i),t<o?(addLog({time:new Date().toLocaleTimeString(),message:`执行出错: ${i.message}，等待3秒后重试...`,type:"warning"}),await new Promise(c=>setTimeout(c,3e3)),t++):(tokenStatus.value[s]="failed",addLog({time:new Date().toLocaleTimeString(),message:`执行失败: ${i.message}`,type:"error"}))}},{taskName:"批量日常任务"}),tokenStore.finishTask()},batchClaimBoxPointReward=async()=>{await executeBatchTask(selectedTokens.value,async(s,e)=>{addLog({time:new Date().toLocaleTimeString(),message:"领取宝箱积分...",type:"info"}),await tokenStore.sendMessageWithPromise(s,"item_batchclaimboxpointreward",{},1e4),await tokenStore.sendMessage(s,"role_getroleinfo")},{taskName:"领取宝箱积分"})},batchOpenBox=async(s=!1)=>{const e=s?batchSettings.defaultBoxType:helperSettings.boxType,t=s?batchSettings.boxCount:helperSettings.count,o=Math.floor(t/10),a=t%10,i={2001:"木质宝箱",2002:"青铜宝箱",2003:"黄金宝箱",2004:"铂金宝箱"};await executeBatchTask(selectedTokens.value,async(c,l)=>{addLog({time:new Date().toLocaleTimeString(),message:`宝箱类型: ${i[e]}, 数量: ${t}`,type:"info"});for(let d=0;d<o&&!shouldStop.value;d++)await tokenStore.sendMessageWithPromise(c,"item_openbox",{itemId:e,number:10},5e3),currentProgress.value=Math.floor((d+1)/(o+(a>0?1:0))*100),addLog({time:new Date().toLocaleTimeString(),message:`开箱进度: ${(d+1)*10}/${t}`,type:"info"}),await new Promise(y=>setTimeout(y,300));a>0&&!shouldStop.value&&(await tokenStore.sendMessageWithPromise(c,"item_openbox",{itemId:e,number:a},5e3),addLog({time:new Date().toLocaleTimeString(),message:`开箱进度: ${t}/${t}`,type:"info"})),await tokenStore.sendMessageWithPromise(c,"item_batchclaimboxpointreward"),await new Promise(d=>setTimeout(d,500)),await tokenStore.sendMessage(c,"role_getroleinfo")},{taskName:"批量开箱"})},batchFish=async()=>{const s=helperSettings.count,e=Math.floor(s/10),t=s%10;await executeBatchTask(selectedTokens.value,async(o,a)=>{addLog({time:new Date().toLocaleTimeString(),message:`开始批量钓鱼: ${s} 次`,type:"info"});for(let i=0;i<e&&!shouldStop.value;i++)await tokenStore.sendMessageWithPromise(o,"artifact_lottery",{lotteryNumber:10,newFree:!0,type:1},1e4),currentProgress.value=Math.floor((i+1)/(e+(t>0?1:0))*100),addLog({time:new Date().toLocaleTimeString(),message:`钓鱼进度: ${(i+1)*10}/${s}`,type:"info"}),await new Promise(c=>setTimeout(c,500));t>0&&!shouldStop.value&&(await tokenStore.sendMessageWithPromise(o,"artifact_lottery",{lotteryNumber:t,newFree:!0,type:1},5e3),addLog({time:new Date().toLocaleTimeString(),message:`钓鱼进度: ${s}/${s}`,type:"info"})),await tokenStore.sendMessage(o,"role_getroleinfo")},{taskName:"批量钓鱼"})},batchRecruit=async()=>{const s=helperSettings.count,e=Math.floor(s/10),t=s%10;await executeBatchTask(selectedTokens.value,async(o,a)=>{addLog({time:new Date().toLocaleTimeString(),message:`开始批量招募: ${s} 次`,type:"info"});for(let i=0;i<e&&!shouldStop.value;i++)await tokenStore.sendMessageWithPromise(o,"recruit_startrecruit",{recruitNumber:10,type:1},1e4),currentProgress.value=Math.floor((i+1)/(e+(t>0?1:0))*100),addLog({time:new Date().toLocaleTimeString(),message:`招募进度: ${(i+1)*10}/${s}`,type:"info"}),await new Promise(c=>setTimeout(c,500));t>0&&!shouldStop.value&&(await tokenStore.sendMessageWithPromise(o,"recruit_startrecruit",{recruitNumber:t,type:1},5e3),addLog({time:new Date().toLocaleTimeString(),message:`招募进度: ${s}/${s}`,type:"info"})),await tokenStore.sendMessage(o,"role_getroleinfo")},{taskName:"批量招募"})},batchLegacyClaim=async()=>{await executeBatchTask(selectedTokens.value,async(s,e)=>{addLog({time:new Date().toLocaleTimeString(),message:"领取功法残卷...",type:"info"});const t=await tokenStore.sendMessageWithPromise(s,"legacy_claimhangup",{},5e3);addLog({time:new Date().toLocaleTimeString(),message:`成功领取功法残卷 ${t.reward[0].value}，共有 ${t.role.items[37007].quantity} 个`,type:"success"})},{taskName:"领取功法残卷"})},batchLegacyGiftSendEnhanced=async(s=!1)=>{const e=s?batchSettings.receiverId:recipientIdInput.value,t=s?batchSettings.password:securityPassword.value,o=s?0:giftQuantity.value||0;await executeBatchTask(selectedTokens.value,async(a,i)=>{var d,y,p,r;let c=0;const l=1;for(;c<=l;)try{const h=await tokenStore.sendGetRoleInfo(a),m=((p=(y=(d=h==null?void 0:h.role)==null?void 0:d.items)==null?void 0:y[37007])==null?void 0:p.quantity)||0;if(m===0){addLog({time:new Date().toLocaleTimeString(),message:"功法残卷不足",type:"warning"});return}const g=await tokenStore.sendMessageWithPromise(a,"rank_getroleinfo",{bottleType:0,includeBottleTeam:!1,isSearch:!1,roleId:Number(e)},5e3);if(!((r=g==null?void 0:g.roleInfo)!=null&&r.roleId))throw new Error(`接收者 ${e} 不存在`);const v=g.roleInfo.name,u=g.roleInfo.serverName,f=s?m:Math.min(m,o);if(f<=0){addLog({time:new Date().toLocaleTimeString(),message:"赠送数量无效",type:"warning"});return}addLog({time:new Date().toLocaleTimeString(),message:`向 [${u}] ${v} 赠送 ${f} 个残卷...`,type:"info"}),await tokenStore.sendMessageWithPromise(a,"legacy_giftsend",{itemId:37007,password:t,quantity:f,roleId:Number(e),roleName:v,serverName:u},1e4),addLog({time:new Date().toLocaleTimeString(),message:"赠送成功",type:"success"});break}catch(h){if(console.error(h),c<l)c++,await new Promise(m=>setTimeout(m,2e3));else throw h}},{taskName:"赠送功法残卷"})},batchClaimFreeEnergy=async()=>{await executeBatchTask(selectedTokens.value,async(s,e)=>{var o;addLog({time:new Date().toLocaleTimeString(),message:"获取怪异塔信息...",type:"info"});const t=await tokenStore.sendMessageWithPromise(s,"mergebox_getinfo",{actType:1},5e3);((o=t==null?void 0:t.mergeBox)==null?void 0:o.freeEnergy)>0?(await tokenStore.sendMessageWithPromise(s,"mergebox_claimfreeenergy",{actType:1},5e3),addLog({time:new Date().toLocaleTimeString(),message:`成功领取免费道具 ${t.mergeBox.freeEnergy} 个`,type:"success"})):addLog({time:new Date().toLocaleTimeString(),message:"暂无免费道具可领取",type:"info"})},{taskName:"领取怪异塔道具"})},stopBatch=()=>{shouldStop.value=!0,addLog({time:new Date().toLocaleTimeString(),message:"正在停止...",type:"warning"})};return(s,e)=>{const t=resolveComponent("n-button"),o=resolveComponent("n-icon"),a=resolveComponent("n-space"),i=resolveComponent("n-checkbox"),c=resolveComponent("n-tag"),l=resolveComponent("n-grid-item"),d=resolveComponent("n-grid"),y=resolveComponent("n-checkbox-group"),p=resolveComponent("n-card"),r=resolveComponent("n-progress"),h=resolveComponent("n-popover"),m=resolveComponent("n-select"),g=resolveComponent("n-switch"),v=resolveComponent("n-modal"),u=resolveComponent("n-input"),f=resolveComponent("n-text"),w=resolveComponent("n-input-number"),x=resolveComponent("n-radio"),T=resolveComponent("n-radio-group"),b=resolveComponent("n-time-picker"),S=resolveComponent("n-divider");return openBlock(),createElementBlock("div",_hoisted_1,[createBaseVNode("div",_hoisted_2,[createBaseVNode("div",_hoisted_3,[createBaseVNode("div",_hoisted_4,[createBaseVNode("div",_hoisted_5,[e[58]||(e[58]=createBaseVNode("h2",null,"批量日常任务",-1)),createBaseVNode("div",_hoisted_6,[createBaseVNode("div",_hoisted_7," 共 "+toDisplayString(scheduledTasks.value.length)+" 个定时任务 ",1),shortestCountdownTask.value?(openBlock(),createElementBlock("div",_hoisted_8," 即将执行："+toDisplayString(shortestCountdownTask.value.task.name)+" ("+toDisplayString(shortestCountdownTask.value.countdown.formatted)+") ",1)):(openBlock(),createElementBlock("div",_hoisted_9," 暂无定时任务 ")),createBaseVNode("div",_hoisted_10,[createVNode(t,{type:"primary",size:"small",onClick:openTaskModal},{default:withCtx(()=>[...e[56]||(e[56]=[createTextVNode(" 新增定时任务 ",-1)])]),_:1}),createVNode(t,{size:"small",onClick:e[0]||(e[0]=n=>showTasksModal.value=!0)},{default:withCtx(()=>[...e[57]||(e[57]=[createTextVNode(" 查看定时任务 ",-1)])]),_:1})])])]),createBaseVNode("div",_hoisted_11,[createVNode(t,{type:"primary",onClick:startBatch,disabled:isRunning.value||selectedTokens.value.length===0,size:"medium"},{default:withCtx(()=>[createTextVNode(toDisplayString(isRunning.value?"执行中...":"开始执行"),1)]),_:1},8,["disabled"]),createVNode(t,{onClick:stopBatch,disabled:!isRunning.value,type:"error",size:"medium"},{default:withCtx(()=>[...e[59]||(e[59]=[createTextVNode(" 停止 ",-1)])]),_:1},8,["disabled"]),createVNode(t,{onClick:openBatchSettings,size:"medium"},{icon:withCtx(()=>[createVNode(o,null,{default:withCtx(()=>[createVNode(unref(Settings))]),_:1})]),default:withCtx(()=>[e[60]||(e[60]=createTextVNode(" 设置 ",-1))]),_:1})])]),createVNode(p,{title:"账号列表",class:"token-list-card"},{default:withCtx(()=>[createVNode(a,{style:{"margin-bottom":"12px"}},{default:withCtx(()=>[createVNode(t,{size:"small",onClick:claimHangUpRewards,disabled:isRunning.value||selectedTokens.value.length===0},{default:withCtx(()=>[...e[61]||(e[61]=[createTextVNode(" 领取挂机 ",-1)])]),_:1},8,["disabled"]),createVNode(t,{size:"small",onClick:batchAddHangUpTime,disabled:isRunning.value||selectedTokens.value.length===0},{default:withCtx(()=>[...e[62]||(e[62]=[createTextVNode(" 一键加钟 ",-1)])]),_:1},8,["disabled"]),createVNode(t,{size:"small",onClick:resetBottles,disabled:isRunning.value||selectedTokens.value.length===0},{default:withCtx(()=>[...e[63]||(e[63]=[createTextVNode(" 重置罐子 ",-1)])]),_:1},8,["disabled"]),createVNode(t,{size:"small",onClick:batchlingguanzi,disabled:isRunning.value||selectedTokens.value.length===0},{default:withCtx(()=>[...e[64]||(e[64]=[createTextVNode(" 一键领取罐子 ",-1)])]),_:1},8,["disabled"]),createVNode(t,{size:"small",onClick:climbTower,disabled:isRunning.value||selectedTokens.value.length===0},{default:withCtx(()=>[...e[65]||(e[65]=[createTextVNode(" 一键爬塔 ",-1)])]),_:1},8,["disabled"]),createVNode(t,{size:"small",onClick:batchStudy,disabled:isRunning.value||selectedTokens.value.length===0},{default:withCtx(()=>[...e[66]||(e[66]=[createTextVNode(" 一键答题 ",-1)])]),_:1},8,["disabled"]),createVNode(t,{size:"small",onClick:batchSmartSendCar,disabled:isRunning.value||selectedTokens.value.length===0||!isCarActivityOpen.value},{default:withCtx(()=>[...e[67]||(e[67]=[createTextVNode(" 智能发车 ",-1)])]),_:1},8,["disabled"]),createVNode(t,{size:"small",onClick:batchClaimCars,disabled:isRunning.value||selectedTokens.value.length===0||!isCarActivityOpen.value},{default:withCtx(()=>[...e[68]||(e[68]=[createTextVNode(" 一键收车 ",-1)])]),_:1},8,["disabled"]),createVNode(t,{size:"small",onClick:e[1]||(e[1]=n=>openHelperModal("box")),disabled:isRunning.value||selectedTokens.value.length===0},{default:withCtx(()=>[...e[69]||(e[69]=[createTextVNode(" 批量开箱 ",-1)])]),_:1},8,["disabled"]),createVNode(t,{size:"small",onClick:batchClaimBoxPointReward,disabled:isRunning.value||selectedTokens.value.length===0},{default:withCtx(()=>[...e[70]||(e[70]=[createTextVNode(" 领取宝箱积分 ",-1)])]),_:1},8,["disabled"]),createVNode(t,{size:"small",onClick:e[2]||(e[2]=n=>openHelperModal("fish")),disabled:isRunning.value||selectedTokens.value.length===0},{default:withCtx(()=>[...e[71]||(e[71]=[createTextVNode(" 批量钓鱼 ",-1)])]),_:1},8,["disabled"]),createVNode(t,{size:"small",onClick:e[3]||(e[3]=n=>openHelperModal("recruit")),disabled:isRunning.value||selectedTokens.value.length===0},{default:withCtx(()=>[...e[72]||(e[72]=[createTextVNode(" 批量招募 ",-1)])]),_:1},8,["disabled"]),createVNode(t,{size:"small",onClick:batchbaoku13,disabled:isRunning.value||selectedTokens.value.length===0||!isbaokuActivityOpen.value},{default:withCtx(()=>[...e[73]||(e[73]=[createTextVNode(" 一键宝库前3层 ",-1)])]),_:1},8,["disabled"]),createVNode(t,{size:"small",onClick:batchbaoku45,disabled:isRunning.value||selectedTokens.value.length===0||!isbaokuActivityOpen.value},{default:withCtx(()=>[...e[74]||(e[74]=[createTextVNode(" 一键宝库4,5层 ",-1)])]),_:1},8,["disabled"]),createVNode(t,{size:"small",onClick:batchmengjing,disabled:isRunning.value||selectedTokens.value.length===0||!ismengjingActivityOpen.value},{default:withCtx(()=>[...e[75]||(e[75]=[createTextVNode(" 一键梦境 ",-1)])]),_:1},8,["disabled"]),createVNode(t,{size:"small",onClick:batchclubsign,disabled:isRunning.value||selectedTokens.value.length===0},{default:withCtx(()=>[...e[76]||(e[76]=[createTextVNode(" 一键俱乐部签到 ",-1)])]),_:1},8,["disabled"]),createVNode(t,{size:"small",onClick:batcharenafight,disabled:isRunning.value||selectedTokens.value.length===0||!isarenaActivityOpen.value},{default:withCtx(()=>[...e[77]||(e[77]=[createTextVNode(" 一键竞技场战斗3次 ",-1)])]),_:1},8,["disabled"]),createVNode(t,{size:"small",onClick:batchTopUpFish,disabled:isRunning.value||selectedTokens.value.length===0},{default:withCtx(()=>[...e[78]||(e[78]=[createTextVNode(" 一键钓鱼补齐 ",-1)])]),_:1},8,["disabled"]),createVNode(t,{size:"small",onClick:batchTopUpArena,disabled:isRunning.value||selectedTokens.value.length===0||!isarenaActivityOpen.value},{default:withCtx(()=>[...e[79]||(e[79]=[createTextVNode(" 一键竞技场补齐 ",-1)])]),_:1},8,["disabled"]),createVNode(t,{size:"small",onClick:batchClaimFreeEnergy,disabled:isRunning.value||selectedTokens.value.length===0||!isWeirdTowerActivityOpen.value},{default:withCtx(()=>[...e[80]||(e[80]=[createTextVNode(" 一键领取怪异塔免费道具 ",-1)])]),_:1},8,["disabled"]),createVNode(t,{size:"small",onClick:legion_storebuygoods,disabled:isRunning.value||selectedTokens.value.length===0},{default:withCtx(()=>[...e[81]||(e[81]=[createTextVNode(" 一键购买四圣碎片 ",-1)])]),_:1},8,["disabled"]),createVNode(t,{size:"small",onClick:legionStoreBuySkinCoins,disabled:isRunning.value||selectedTokens.value.length===0},{default:withCtx(()=>[...e[82]||(e[82]=[createTextVNode(" 一键购买俱乐部5皮肤币 ",-1)])]),_:1},8,["disabled"]),createVNode(t,{size:"small",onClick:store_purchase,disabled:isRunning.value||selectedTokens.value.length===0},{default:withCtx(()=>[...e[83]||(e[83]=[createTextVNode(" 一键黑市采购 ",-1)])]),_:1},8,["disabled"]),createVNode(t,{size:"small",onClick:collection_claimfreereward,disabled:isRunning.value||selectedTokens.value.length===0},{default:withCtx(()=>[...e[84]||(e[84]=[createTextVNode(" 免费领取珍宝阁 ",-1)])]),_:1},8,["disabled"]),createVNode(t,{size:"small",onClick:batchLegacyClaim,disabled:isRunning.value||selectedTokens.value.length===0},{default:withCtx(()=>[...e[85]||(e[85]=[createTextVNode(" 批量功法残卷领取 ",-1)])]),_:1},8,["disabled"]),createVNode(t,{size:"small",onClick:e[4]||(e[4]=n=>showLegacyGiftModal.value=!0),disabled:isRunning.value||selectedTokens.value.length===0},{default:withCtx(()=>[...e[86]||(e[86]=[createTextVNode(" 批量功法残卷赠送 ",-1)])]),_:1},8,["disabled"])]),_:1}),createVNode(a,{vertical:""},{default:withCtx(()=>[createVNode(i,{checked:isAllSelected.value,indeterminate:isIndeterminate.value,"onUpdate:checked":handleSelectAll},{default:withCtx(()=>[...e[87]||(e[87]=[createTextVNode(" 全选 ",-1)])]),_:1},8,["checked","indeterminate"]),createVNode(y,{value:selectedTokens.value,"onUpdate:value":e[5]||(e[5]=n=>selectedTokens.value=n)},{default:withCtx(()=>[createVNode(d,{"x-gap":12,"y-gap":8,cols:batchSettings.tokenListColumns},{default:withCtx(()=>[(openBlock(!0),createElementBlock(Fragment,null,renderList(tokens.value,n=>(openBlock(),createBlock(l,{key:n.id},{default:withCtx(()=>[createBaseVNode("div",_hoisted_12,[createVNode(i,{value:n.id,label:n.name,style:{flex:"1"}},{default:withCtx(()=>[createBaseVNode("div",_hoisted_13,[createBaseVNode("span",null,toDisplayString(n.name),1),createVNode(c,{size:"small",type:getStatusType(n.id),style:{"margin-left":"8px"}},{default:withCtx(()=>[createTextVNode(toDisplayString(getStatusText(n.id)),1)]),_:2},1032,["type"])])]),_:2},1032,["value","label"]),createVNode(t,{size:"tiny",circle:"",onClick:withModifiers(k=>openSettings(n),["stop"])},{icon:withCtx(()=>[createVNode(o,null,{default:withCtx(()=>[createVNode(unref(Settings))]),_:1})]),_:1},8,["onClick"])])]),_:2},1024))),128))]),_:1},8,["cols"])]),_:1},8,["value"])]),_:1})]),_:1}),batchSettings.hideScheduledTasksModule?createCommentVNode("",!0):(openBlock(),createBlock(p,{key:0,title:"定时任务",class:"scheduled-tasks-card",style:{"margin-top":"16px"}},{default:withCtx(()=>[createVNode(a,{style:{"margin-bottom":"12px"}},{default:withCtx(()=>[createVNode(t,{type:"primary",size:"small",onClick:openTaskModal},{default:withCtx(()=>[...e[88]||(e[88]=[createTextVNode(" 新增定时任务 ",-1)])]),_:1}),createVNode(t,{size:"small",onClick:e[6]||(e[6]=n=>showTasksModal.value=!0)},{default:withCtx(()=>[...e[89]||(e[89]=[createTextVNode(" 查看定时任务 ",-1)])]),_:1})]),_:1}),createBaseVNode("div",_hoisted_14,[e[90]||(e[90]=createBaseVNode("h4",{style:{margin:"0 0 12px 0",color:"#333"}},"即将执行的任务",-1)),shortestCountdownTask.value?(openBlock(),createElementBlock("div",_hoisted_15,[createBaseVNode("div",_hoisted_16,toDisplayString(shortestCountdownTask.value.task.name),1),createBaseVNode("div",{style:normalizeStyle([{"font-size":"24px","font-weight":"bold",color:"#1677ff"},{color:shortestCountdownTask.value.countdown.isNearExecution?"#ff4d4f":"#1677ff"}])},toDisplayString(shortestCountdownTask.value.countdown.formatted),5)])):(openBlock(),createElementBlock("div",_hoisted_17," 暂无定时任务 "))]),scheduledTasks.value.length>0?(openBlock(),createElementBlock("div",_hoisted_18,[createBaseVNode("p",null,"已保存 "+toDisplayString(scheduledTasks.value.length)+" 个定时任务",1)])):(openBlock(),createElementBlock("div",_hoisted_19,[...e[91]||(e[91]=[createBaseVNode("p",null,"暂无定时任务",-1)])]))]),_:1}))]),createBaseVNode("div",_hoisted_20,[createVNode(p,{title:"连接池监控",size:"small",class:"monitor-card"},{"header-extra":withCtx(()=>[createVNode(c,{type:poolStats.value.activeConnections>0?"success":"info",size:"small"},{default:withCtx(()=>[createTextVNode(" 活跃: "+toDisplayString(poolStats.value.activeConnections)+"/"+toDisplayString(poolStats.value.maxConnections),1)]),_:1},8,["type"])]),default:withCtx(()=>[createBaseVNode("div",_hoisted_21,[createBaseVNode("div",_hoisted_22,[createBaseVNode("div",_hoisted_23,[e[92]||(e[92]=createBaseVNode("div",{style:{color:"#86909c"}},"排队任务",-1)),createBaseVNode("div",_hoisted_24,toDisplayString(poolStats.value.queueLength),1)]),createBaseVNode("div",_hoisted_25,[e[93]||(e[93]=createBaseVNode("div",{style:{color:"#86909c"}},"健康状态",-1)),createBaseVNode("div",{style:normalizeStyle([{"font-size":"16px","font-weight":"bold"},{color:healthReport.value.unhealthyConnections>0?"#ff4d4f":"#52c41a"}])},toDisplayString(healthReport.value.healthyConnections)+"/"+toDisplayString(healthReport.value.totalConnections),5)])]),poolStats.value.activeTasks&&poolStats.value.activeTasks.length>0?(openBlock(),createElementBlock("div",_hoisted_26,[e[94]||(e[94]=createBaseVNode("div",{style:{"margin-bottom":"4px","font-weight":"bold",color:"#4b5563"}},"正在执行:",-1)),(openBlock(!0),createElementBlock(Fragment,null,renderList(poolStats.value.activeTasks,n=>{var k;return openBlock(),createElementBlock("div",{key:n.tokenId,class:"active-task-item",style:{display:"flex","justify-content":"space-between",padding:"4px 8px",background:"#f3f4f6","border-radius":"4px","margin-bottom":"4px"}},[createBaseVNode("span",null,toDisplayString(((k=unref(tokenStore).gameTokens.find(N=>N.id===n.tokenId))==null?void 0:k.name)||n.tokenId),1),createVNode(c,{size:"tiny",type:"success"},{default:withCtx(()=>[createTextVNode(toDisplayString(n.priority)+"级",1)]),_:2},1024)])}),128))])):(openBlock(),createElementBlock("div",_hoisted_27," 暂无执行中的连接 "))])]),_:1}),createVNode(p,{class:"log-card"},{header:withCtx(()=>[createBaseVNode("div",_hoisted_28,[createBaseVNode("div",_hoisted_29,toDisplayString(currentRunningTokenName.value?`正在执行: ${currentRunningTokenName.value}`:"执行日志"),1),createBaseVNode("div",_hoisted_30,[createVNode(i,{checked:autoScrollLog.value,"onUpdate:checked":e[7]||(e[7]=n=>autoScrollLog.value=n),size:"small"},{default:withCtx(()=>[...e[95]||(e[95]=[createTextVNode(" 自动滚动 ",-1)])]),_:1},8,["checked"]),createVNode(i,{checked:filterErrorsOnly.value,"onUpdate:checked":e[8]||(e[8]=n=>filterErrorsOnly.value=n),size:"small"},{default:withCtx(()=>[...e[96]||(e[96]=[createTextVNode(" 只看错误 ",-1)])]),_:1},8,["checked"]),errorCount.value>0?(openBlock(),createBlock(c,{key:0,type:"error",size:"small"},{default:withCtx(()=>[createTextVNode(toDisplayString(errorCount.value)+" 个错误 ",1)]),_:1})):createCommentVNode("",!0),createVNode(t,{size:"small",onClick:copyLogs},{default:withCtx(()=>[...e[97]||(e[97]=[createTextVNode(" 复制日志 ",-1)])]),_:1})])])]),default:withCtx(()=>[createVNode(r,{type:"line",percentage:currentProgress.value,"indicator-placement":"inside",processing:""},null,8,["percentage"]),createBaseVNode("div",{class:"log-container",ref_key:"logContainer",ref:logContainer,onScroll:handleScroll},[(openBlock(!0),createElementBlock(Fragment,null,renderList(filteredLogs.value,(n,k)=>(openBlock(),createElementBlock("div",{key:k,class:normalizeClass(["log-item",n.type])},[createBaseVNode("span",_hoisted_31,toDisplayString(n.time),1),createBaseVNode("span",_hoisted_32,toDisplayString(n.message),1)],2))),128))],544),createBaseVNode("div",_hoisted_33,[createBaseVNode("div",_hoisted_34,[createVNode(a,{size:8},{default:withCtx(()=>[createVNode(c,{bordered:!1,type:"success",size:"small"},{default:withCtx(()=>[createTextVNode(" 成功: "+toDisplayString(batchExecutionStats.value.successCount),1)]),_:1}),batchExecutionStats.value.failedCount>0?(openBlock(),createBlock(h,{key:0,trigger:"hover",placement:"top"},{trigger:withCtx(()=>[createVNode(c,{bordered:!1,type:"error",size:"small",style:{cursor:"pointer"}},{default:withCtx(()=>[createTextVNode(" 失败: "+toDisplayString(batchExecutionStats.value.failedCount)+" (查看详情) ",1)]),_:1})]),default:withCtx(()=>[createBaseVNode("div",_hoisted_35,[(openBlock(!0),createElementBlock(Fragment,null,renderList(batchExecutionStats.value.failedTokens,n=>(openBlock(),createElementBlock("div",{key:n.id,style:{"margin-bottom":"8px","font-size":"12px",display:"flex","align-items":"center","justify-content":"space-between",gap:"12px"}},[createBaseVNode("div",_hoisted_36,[createBaseVNode("span",_hoisted_37,"• "+toDisplayString(n.name),1),createBaseVNode("span",_hoisted_38,"任务: "+toDisplayString(n.taskName),1)]),createVNode(t,{size:"tiny",type:"primary",secondary:"",onClick:k=>retryTaskForToken(n.id)},{default:withCtx(()=>[...e[98]||(e[98]=[createTextVNode(" 补做 ",-1)])]),_:1},8,["onClick"])]))),128))])]),_:1})):(openBlock(),createBlock(c,{key:1,bordered:!1,type:"error",size:"small"},{default:withCtx(()=>[...e[99]||(e[99]=[createTextVNode(" 失败: 0 ",-1)])]),_:1}))]),_:1})]),createBaseVNode("div",_hoisted_39," 总计: "+toDisplayString(batchExecutionStats.value.totalCount),1)])]),_:1})])]),createVNode(v,{show:showSettingsModal.value,"onUpdate:show":e[19]||(e[19]=n=>showSettingsModal.value=n),preset:"card",title:`任务设置 - ${currentSettingsTokenName.value}`,style:{width:"90%","max-width":"400px"}},{default:withCtx(()=>[createBaseVNode("div",_hoisted_40,[createBaseVNode("div",_hoisted_41,[createBaseVNode("div",_hoisted_42,[e[100]||(e[100]=createBaseVNode("label",{class:"setting-label"},"竞技场阵容",-1)),createVNode(m,{value:currentSettings.arenaFormation,"onUpdate:value":e[9]||(e[9]=n=>currentSettings.arenaFormation=n),options:unref(formationOptions),size:"small"},null,8,["value","options"])]),createBaseVNode("div",_hoisted_43,[e[101]||(e[101]=createBaseVNode("label",{class:"setting-label"},"BOSS阵容",-1)),createVNode(m,{value:currentSettings.bossFormation,"onUpdate:value":e[10]||(e[10]=n=>currentSettings.bossFormation=n),options:unref(formationOptions),size:"small"},null,8,["value","options"])]),createBaseVNode("div",_hoisted_44,[e[102]||(e[102]=createBaseVNode("label",{class:"setting-label"},"BOSS次数",-1)),createVNode(m,{value:currentSettings.bossTimes,"onUpdate:value":e[11]||(e[11]=n=>currentSettings.bossTimes=n),options:unref(bossTimesOptions),size:"small"},null,8,["value","options"])]),createBaseVNode("div",_hoisted_45,[createBaseVNode("div",_hoisted_46,[e[103]||(e[103]=createBaseVNode("span",{class:"switch-label"},"领罐子",-1)),createVNode(g,{value:currentSettings.claimBottle,"onUpdate:value":e[12]||(e[12]=n=>currentSettings.claimBottle=n)},null,8,["value"])]),createBaseVNode("div",_hoisted_47,[e[104]||(e[104]=createBaseVNode("span",{class:"switch-label"},"领挂机",-1)),createVNode(g,{value:currentSettings.claimHangUp,"onUpdate:value":e[13]||(e[13]=n=>currentSettings.claimHangUp=n)},null,8,["value"])]),createBaseVNode("div",_hoisted_48,[e[105]||(e[105]=createBaseVNode("span",{class:"switch-label"},"竞技场",-1)),createVNode(g,{value:currentSettings.arenaEnable,"onUpdate:value":e[14]||(e[14]=n=>currentSettings.arenaEnable=n)},null,8,["value"])]),createBaseVNode("div",_hoisted_49,[e[106]||(e[106]=createBaseVNode("span",{class:"switch-label"},"开宝箱",-1)),createVNode(g,{value:currentSettings.openBox,"onUpdate:value":e[15]||(e[15]=n=>currentSettings.openBox=n)},null,8,["value"])]),createBaseVNode("div",_hoisted_50,[e[107]||(e[107]=createBaseVNode("span",{class:"switch-label"},"领取邮件奖励",-1)),createVNode(g,{value:currentSettings.claimEmail,"onUpdate:value":e[16]||(e[16]=n=>currentSettings.claimEmail=n)},null,8,["value"])]),createBaseVNode("div",_hoisted_51,[e[108]||(e[108]=createBaseVNode("span",{class:"switch-label"},"黑市购买物品",-1)),createVNode(g,{value:currentSettings.blackMarketPurchase,"onUpdate:value":e[17]||(e[17]=n=>currentSettings.blackMarketPurchase=n)},null,8,["value"])]),createBaseVNode("div",_hoisted_52,[e[109]||(e[109]=createBaseVNode("span",{class:"switch-label"},"付费招募",-1)),createVNode(g,{value:currentSettings.payRecruit,"onUpdate:value":e[18]||(e[18]=n=>currentSettings.payRecruit=n)},null,8,["value"])])])]),createBaseVNode("div",_hoisted_53,[createVNode(t,{type:"primary",onClick:saveSettings},{default:withCtx(()=>[...e[110]||(e[110]=[createTextVNode("保存设置",-1)])]),_:1})])])]),_:1},8,["show","title"]),createVNode(v,{show:showLegacyGiftModal.value,"onUpdate:show":e[24]||(e[24]=n=>showLegacyGiftModal.value=n),preset:"card",title:"批量功法残卷赠送",style:{width:"90%","max-width":"600px"}},{default:withCtx(()=>[createBaseVNode("div",_hoisted_54,[createBaseVNode("div",_hoisted_55,[createBaseVNode("div",_hoisted_56,[e[112]||(e[112]=createBaseVNode("label",{class:"setting-label"},"接收者ID",-1)),createVNode(a,null,{default:withCtx(()=>[createVNode(u,{value:recipientIdInput.value,"onUpdate:value":e[20]||(e[20]=n=>recipientIdInput.value=n),placeholder:"请输入接收者ID",type:"number",onInput:clearRecipientError,style:{width:"180px"}},null,8,["value"]),createVNode(u,{value:securityPassword.value,"onUpdate:value":e[21]||(e[21]=n=>securityPassword.value=n),placeholder:"请输入安全密码",type:"password",onInput:clearRecipientError,style:{width:"180px"}},null,8,["value"]),createVNode(t,{type:"primary",onClick:queryRecipientInfo,disabled:!recipientIdInput.value||isQueryingRecipient.value||!securityPassword.value},{default:withCtx(()=>[...e[111]||(e[111]=[createTextVNode(" 查询 ",-1)])]),_:1},8,["disabled"])]),_:1}),recipientIdError.value?(openBlock(),createBlock(f,{key:0,type:"error",style:{"margin-top":"5px",display:"block"}},{default:withCtx(()=>[createTextVNode(toDisplayString(recipientIdError.value),1)]),_:1})):createCommentVNode("",!0)]),recipientInfo.value?(openBlock(),createElementBlock("div",_hoisted_57,[e[119]||(e[119]=createBaseVNode("label",{class:"setting-label"},"接收者信息",-1)),createBaseVNode("div",_hoisted_58,[createBaseVNode("div",_hoisted_59,[recipientInfo.value.avatarUrl&&!avatarLoadError.value?(openBlock(),createElementBlock("img",{key:0,src:recipientInfo.value.avatarUrl,alt:"角色头像",style:{width:"100%",height:"100%","object-fit":"cover",transition:"all 0.3s ease"},onError:handleAvatarError,onLoad:handleAvatarLoad},null,40,_hoisted_60)):(openBlock(),createElementBlock("div",_hoisted_61,toDisplayString((recipientInfo.value.name||"未知角色")[0]||"?"),1)),isAvatarLoading.value?(openBlock(),createElementBlock("div",_hoisted_62,[...e[113]||(e[113]=[createBaseVNode("div",{class:"loading-spinner",style:{width:"30px",height:"30px",border:"3px solid rgba(255, 255, 255, 0.3)","border-top":"3px solid white","border-radius":"50%",animation:"spin 1s linear infinite"}},null,-1)])])):createCommentVNode("",!0)]),createBaseVNode("div",_hoisted_63,[createBaseVNode("div",_hoisted_64,toDisplayString(recipientInfo.value.name||"未知角色"),1),createBaseVNode("div",_hoisted_65,[createBaseVNode("div",_hoisted_66,[e[114]||(e[114]=createBaseVNode("div",{class:"info-label",style:{"font-size":"12px",color:"#86909c","margin-bottom":"2px"}},"角色ID",-1)),createBaseVNode("div",_hoisted_67,toDisplayString(recipientInfo.value.roleId),1)]),createBaseVNode("div",_hoisted_68,[e[115]||(e[115]=createBaseVNode("div",{class:"info-label",style:{"font-size":"12px",color:"#86909c","margin-bottom":"2px"}},"服务器",-1)),createBaseVNode("div",_hoisted_69,toDisplayString(recipientInfo.value.serverName),1)]),createBaseVNode("div",_hoisted_70,[e[116]||(e[116]=createBaseVNode("div",{class:"info-label",style:{"font-size":"12px",color:"#86909c","margin-bottom":"2px"}},"战力",-1)),createBaseVNode("div",_hoisted_71,toDisplayString(recipientInfo.value.power)+" "+toDisplayString(recipientInfo.value.powerUnit),1)]),createBaseVNode("div",_hoisted_72,[e[117]||(e[117]=createBaseVNode("div",{class:"info-label",style:{"font-size":"12px",color:"#86909c","margin-bottom":"2px"}},"军团",-1)),createBaseVNode("div",_hoisted_73,toDisplayString(recipientInfo.value.legionName||"无"),1)]),createBaseVNode("div",_hoisted_74,[e[118]||(e[118]=createBaseVNode("div",{class:"info-label",style:{"font-size":"12px",color:"#86909c","margin-bottom":"2px"}},"军团ID",-1)),createBaseVNode("div",_hoisted_75,toDisplayString(recipientInfo.value.legionId||"无"),1)])])])])])):createCommentVNode("",!0),createBaseVNode("div",_hoisted_76,[e[120]||(e[120]=createBaseVNode("label",{class:"setting-label"},"赠送数量",-1)),createVNode(w,{value:giftQuantity.value,"onUpdate:value":e[22]||(e[22]=n=>giftQuantity.value=n),min:1,max:1e3,step:1,placeholder:"请输入赠送数量"},null,8,["value"])])]),createBaseVNode("div",_hoisted_77,[createVNode(t,{onClick:e[23]||(e[23]=n=>showLegacyGiftModal.value=!1),style:{"margin-right":"12px"}},{default:withCtx(()=>[...e[121]||(e[121]=[createTextVNode("取消",-1)])]),_:1}),createVNode(t,{type:"primary",onClick:confirmLegacyGift,disabled:!recipientIdInput.value||!recipientInfo.value},{default:withCtx(()=>[...e[122]||(e[122]=[createTextVNode(" 开始赠送 ",-1)])]),_:1},8,["disabled"])])])]),_:1},8,["show"]),createVNode(v,{show:showHelperModal.value,"onUpdate:show":e[29]||(e[29]=n=>showHelperModal.value=n),preset:"card",title:helperModalTitle.value,style:{width:"90%","max-width":"400px"}},{default:withCtx(()=>[createBaseVNode("div",_hoisted_78,[createBaseVNode("div",_hoisted_79,[helperType.value==="box"?(openBlock(),createElementBlock("div",_hoisted_80,[e[123]||(e[123]=createBaseVNode("label",{class:"setting-label"},"宝箱类型",-1)),createVNode(m,{value:helperSettings.boxType,"onUpdate:value":e[25]||(e[25]=n=>helperSettings.boxType=n),options:boxTypeOptions,size:"small"},null,8,["value"])])):createCommentVNode("",!0),helperType.value==="fish"?(openBlock(),createElementBlock("div",_hoisted_81,[e[124]||(e[124]=createBaseVNode("label",{class:"setting-label"},"鱼竿类型",-1)),createVNode(m,{value:helperSettings.fishType,"onUpdate:value":e[26]||(e[26]=n=>helperSettings.fishType=n),options:fishTypeOptions,size:"small"},null,8,["value"])])):createCommentVNode("",!0),createBaseVNode("div",_hoisted_82,[e[125]||(e[125]=createBaseVNode("label",{class:"setting-label"},"消耗数量（10的倍数）",-1)),createVNode(w,{value:helperSettings.count,"onUpdate:value":e[27]||(e[27]=n=>helperSettings.count=n),min:10,max:1e4,step:10,size:"small"},null,8,["value"])])]),createBaseVNode("div",_hoisted_83,[createVNode(t,{onClick:e[28]||(e[28]=n=>showHelperModal.value=!1),style:{"margin-right":"12px"}},{default:withCtx(()=>[...e[126]||(e[126]=[createTextVNode("取消",-1)])]),_:1}),createVNode(t,{type:"primary",onClick:executeHelper},{default:withCtx(()=>[...e[127]||(e[127]=[createTextVNode("开始执行",-1)])]),_:1})])])]),_:1},8,["show","title"]),createVNode(v,{show:showTasksModal.value,"onUpdate:show":e[30]||(e[30]=n=>showTasksModal.value=n),preset:"card",title:"定时任务列表",style:{width:"90%","max-width":"800px"}},{default:withCtx(()=>[createBaseVNode("div",_hoisted_84,[(openBlock(!0),createElementBlock(Fragment,null,renderList(scheduledTasks.value,n=>{var k,N;return openBlock(),createElementBlock("div",{key:n.id,class:"task-item",style:{"margin-bottom":"16px",padding:"12px",border:"1px solid #e5e7eb","border-radius":"8px"}},[createBaseVNode("div",_hoisted_85,[createBaseVNode("div",_hoisted_86,toDisplayString(n.name),1),createVNode(g,{value:n.enabled,"onUpdate:value":[C=>n.enabled=C,C=>toggleTaskEnabled(n.id,C)]},null,8,["value","onUpdate:value"])]),createBaseVNode("div",_hoisted_87,[e[128]||(e[128]=createBaseVNode("span",{style:{color:"#6b7280"}},"运行类型：",-1)),createBaseVNode("span",null,toDisplayString(n.runType==="daily"?"每天固定时间":"Cron表达式"),1)]),createBaseVNode("div",_hoisted_88,[e[129]||(e[129]=createBaseVNode("span",{style:{color:"#6b7280"}},"运行时间：",-1)),createBaseVNode("span",null,toDisplayString(n.runType==="daily"?n.runTime:n.cronExpression),1)]),createBaseVNode("div",_hoisted_89,[e[130]||(e[130]=createBaseVNode("span",{style:{color:"#6b7280"}},"下次执行：",-1)),createBaseVNode("span",{style:normalizeStyle({fontWeight:"bold",color:(k=taskCountdowns.value[n.id])!=null&&k.isNearExecution?"#ff4d4f":"#1677ff"})},toDisplayString(((N=taskCountdowns.value[n.id])==null?void 0:N.formatted)||"计算中..."),5)]),createBaseVNode("div",_hoisted_90,[e[131]||(e[131]=createBaseVNode("span",{style:{color:"#6b7280"}},"选中账号：",-1)),createBaseVNode("span",null,toDisplayString(n.selectedTokens.length)+" 个",1)]),createBaseVNode("div",_hoisted_91,[e[132]||(e[132]=createBaseVNode("span",{style:{color:"#6b7280"}},"选中任务：",-1)),createBaseVNode("span",null,toDisplayString(n.selectedTasks.length)+" 个",1)]),createBaseVNode("div",_hoisted_92,[createVNode(t,{size:"tiny",onClick:C=>editTask(n)},{default:withCtx(()=>[...e[133]||(e[133]=[createTextVNode(" 编辑 ",-1)])]),_:1},8,["onClick"]),createVNode(t,{size:"tiny",type:"error",onClick:C=>deleteTask(n.id)},{default:withCtx(()=>[...e[134]||(e[134]=[createTextVNode(" 删除 ",-1)])]),_:1},8,["onClick"])])])}),128)),scheduledTasks.value.length===0?(openBlock(),createElementBlock("div",_hoisted_93," 暂无定时任务 ")):createCommentVNode("",!0)])]),_:1},8,["show"]),createVNode(v,{show:showTaskModal.value,"onUpdate:show":e[38]||(e[38]=n=>showTaskModal.value=n),preset:"card",title:editingTask.value?"编辑定时任务":"新增定时任务",style:{width:"90%","max-width":"600px"}},{default:withCtx(()=>[createBaseVNode("div",_hoisted_94,[createBaseVNode("div",_hoisted_95,[createBaseVNode("div",_hoisted_96,[e[135]||(e[135]=createBaseVNode("label",{class:"setting-label"},"任务名称",-1)),createVNode(u,{value:taskForm.name,"onUpdate:value":e[31]||(e[31]=n=>taskForm.name=n),placeholder:"请输入任务名称"},null,8,["value"])]),createBaseVNode("div",_hoisted_97,[e[138]||(e[138]=createBaseVNode("label",{class:"setting-label"},"运行类型",-1)),createVNode(T,{value:taskForm.runType,"onUpdate:value":[e[32]||(e[32]=n=>taskForm.runType=n),resetRunType]},{default:withCtx(()=>[createVNode(x,{value:"daily"},{default:withCtx(()=>[...e[136]||(e[136]=[createTextVNode("每天固定时间",-1)])]),_:1}),createVNode(x,{value:"cron"},{default:withCtx(()=>[...e[137]||(e[137]=[createTextVNode("Cron表达式",-1)])]),_:1})]),_:1},8,["value"])]),taskForm.runType==="daily"?(openBlock(),createElementBlock("div",_hoisted_98,[e[139]||(e[139]=createBaseVNode("label",{class:"setting-label"},"运行时间",-1)),createVNode(b,{value:taskForm.runTime,"onUpdate:value":e[33]||(e[33]=n=>taskForm.runTime=n),format:"HH:mm"},null,8,["value"])])):createCommentVNode("",!0),taskForm.runType==="cron"?(openBlock(),createElementBlock("div",_hoisted_99,[e[141]||(e[141]=createBaseVNode("label",{class:"setting-label"},"Cron表达式",-1)),createVNode(u,{value:taskForm.cronExpression,"onUpdate:value":e[34]||(e[34]=n=>taskForm.cronExpression=n),placeholder:"请输入Cron表达式",onInput:parseCronExpression},null,8,["value"]),taskForm.cronExpression?(openBlock(),createElementBlock("div",_hoisted_100,[cronValidation.value.valid?(openBlock(),createElementBlock("div",_hoisted_101,[createVNode(f,{type:"success"},{default:withCtx(()=>[createTextVNode("✓ "+toDisplayString(cronValidation.value.message),1)]),_:1})])):(openBlock(),createElementBlock("div",_hoisted_102,[createVNode(f,{type:"error"},{default:withCtx(()=>[createTextVNode("✗ "+toDisplayString(cronValidation.value.message),1)]),_:1})])),cronValidation.value.valid&&cronNextRuns.value.length>0?(openBlock(),createElementBlock("div",_hoisted_103,[e[140]||(e[140]=createBaseVNode("h4",null,"未来5次执行时间：",-1)),createBaseVNode("ul",null,[(openBlock(!0),createElementBlock(Fragment,null,renderList(cronNextRuns.value,(n,k)=>(openBlock(),createElementBlock("li",{key:k},toDisplayString(n),1))),128))])])):createCommentVNode("",!0)])):createCommentVNode("",!0)])):createCommentVNode("",!0),createBaseVNode("div",_hoisted_104,[createBaseVNode("div",_hoisted_105,[e[144]||(e[144]=createBaseVNode("label",{class:"setting-label"},"选择账号",-1)),createVNode(a,{size:"small"},{default:withCtx(()=>[createVNode(t,{size:"small",onClick:selectAllTokens},{default:withCtx(()=>[...e[142]||(e[142]=[createTextVNode(" 全选 ",-1)])]),_:1}),createVNode(t,{size:"small",onClick:deselectAllTokens},{default:withCtx(()=>[...e[143]||(e[143]=[createTextVNode(" 全不选 ",-1)])]),_:1})]),_:1})]),createVNode(y,{value:taskForm.selectedTokens,"onUpdate:value":e[35]||(e[35]=n=>taskForm.selectedTokens=n)},{default:withCtx(()=>[createVNode(d,{cols:2,"x-gap":12,"y-gap":8},{default:withCtx(()=>[(openBlock(!0),createElementBlock(Fragment,null,renderList(tokens.value,n=>(openBlock(),createBlock(l,{key:n.id},{default:withCtx(()=>[createVNode(i,{value:n.id},{default:withCtx(()=>[createTextVNode(toDisplayString(n.name),1)]),_:2},1032,["value"])]),_:2},1024))),128))]),_:1})]),_:1},8,["value"])]),createBaseVNode("div",_hoisted_106,[createBaseVNode("div",_hoisted_107,[e[147]||(e[147]=createBaseVNode("label",{class:"setting-label"},"选择任务",-1)),createVNode(a,{size:"small"},{default:withCtx(()=>[createVNode(t,{size:"small",onClick:selectAllTasks},{default:withCtx(()=>[...e[145]||(e[145]=[createTextVNode(" 全选 ",-1)])]),_:1}),createVNode(t,{size:"small",onClick:deselectAllTasks},{default:withCtx(()=>[...e[146]||(e[146]=[createTextVNode(" 全不选 ",-1)])]),_:1})]),_:1})]),createVNode(y,{value:taskForm.selectedTasks,"onUpdate:value":e[36]||(e[36]=n=>taskForm.selectedTasks=n)},{default:withCtx(()=>[createVNode(d,{cols:2,"x-gap":12,"y-gap":8},{default:withCtx(()=>[(openBlock(),createElementBlock(Fragment,null,renderList(availableTasks,n=>createVNode(l,{key:n.value},{default:withCtx(()=>[createVNode(i,{value:n.value},{default:withCtx(()=>[createTextVNode(toDisplayString(n.label),1)]),_:2},1032,["value"])]),_:2},1024)),64))]),_:1})]),_:1},8,["value"])])]),createBaseVNode("div",_hoisted_108,[createVNode(t,{onClick:e[37]||(e[37]=n=>showTaskModal.value=!1),style:{"margin-right":"12px"}},{default:withCtx(()=>[...e[148]||(e[148]=[createTextVNode("取消",-1)])]),_:1}),createVNode(t,{type:"primary",onClick:saveTask},{default:withCtx(()=>[...e[149]||(e[149]=[createTextVNode("保存",-1)])]),_:1})])])]),_:1},8,["show","title"]),createVNode(v,{show:showBatchSettingsModal.value,"onUpdate:show":e[55]||(e[55]=n=>showBatchSettingsModal.value=n),preset:"card",title:"任务设置",style:{width:"90%","max-width":"400px"}},{default:withCtx(()=>[createBaseVNode("div",_hoisted_109,[e[168]||(e[168]=createBaseVNode("div",{style:{"margin-bottom":"20px",color:"#6b7280","font-size":"14px"}}," 设置定时任务执行批量使用操作时的数量设置 ",-1)),createBaseVNode("div",_hoisted_110,[createBaseVNode("div",_hoisted_111,[e[150]||(e[150]=createBaseVNode("label",{class:"setting-label"},"定时批量开箱数量（10的倍数）",-1)),createVNode(w,{value:batchSettings.boxCount,"onUpdate:value":e[39]||(e[39]=n=>batchSettings.boxCount=n),min:10,max:1e4,step:10,size:"small"},null,8,["value"])]),createBaseVNode("div",_hoisted_112,[e[151]||(e[151]=createBaseVNode("label",{class:"setting-label"},"定时批量钓鱼数量（10的倍数）",-1)),createVNode(w,{value:batchSettings.fishCount,"onUpdate:value":e[40]||(e[40]=n=>batchSettings.fishCount=n),min:10,max:1e4,step:10,size:"small"},null,8,["value"])]),createBaseVNode("div",_hoisted_113,[e[152]||(e[152]=createBaseVNode("label",{class:"setting-label"},"定时批量招募数量（10的倍数）",-1)),createVNode(w,{value:batchSettings.recruitCount,"onUpdate:value":e[41]||(e[41]=n=>batchSettings.recruitCount=n),min:10,max:1e4,step:10,size:"small"},null,8,["value"])]),createBaseVNode("div",_hoisted_114,[e[153]||(e[153]=createBaseVNode("label",{class:"setting-label"},"默认宝箱类型",-1)),createVNode(m,{value:batchSettings.defaultBoxType,"onUpdate:value":e[42]||(e[42]=n=>batchSettings.defaultBoxType=n),options:boxTypeOptions,size:"small"},null,8,["value"])]),createBaseVNode("div",_hoisted_115,[e[154]||(e[154]=createBaseVNode("label",{class:"setting-label"},"默认鱼竿类型",-1)),createVNode(m,{value:batchSettings.defaultFishType,"onUpdate:value":e[43]||(e[43]=n=>batchSettings.defaultFishType=n),options:fishTypeOptions,size:"small"},null,8,["value"])]),createBaseVNode("div",_hoisted_116,[e[155]||(e[155]=createBaseVNode("label",{class:"setting-label"},"接收者ID",-1)),createVNode(u,{value:batchSettings.receiverId,"onUpdate:value":e[44]||(e[44]=n=>batchSettings.receiverId=n),type:"text",placeholder:"请输入接收者ID",size:"small"},null,8,["value"])]),createBaseVNode("div",_hoisted_117,[e[156]||(e[156]=createBaseVNode("label",{class:"setting-label"},"密码设置",-1)),createVNode(u,{value:batchSettings.password,"onUpdate:value":e[45]||(e[45]=n=>batchSettings.password=n),type:"password",placeholder:"请输入密码",size:"small"},null,8,["value"])]),createBaseVNode("div",_hoisted_118,[e[157]||(e[157]=createBaseVNode("label",{class:"setting-label"},"隐藏底部定时任务模块",-1)),createVNode(g,{value:batchSettings.hideScheduledTasksModule,"onUpdate:value":e[46]||(e[46]=n=>batchSettings.hideScheduledTasksModule=n)},null,8,["value"])]),createBaseVNode("div",_hoisted_119,[e[158]||(e[158]=createBaseVNode("label",{class:"setting-label"},"账号列表每行显示数量",-1)),createVNode(w,{value:batchSettings.tokenListColumns,"onUpdate:value":e[47]||(e[47]=n=>batchSettings.tokenListColumns=n),min:1,max:10,step:1,size:"small",style:{width:"100px"}},null,8,["value"])]),createBaseVNode("div",_hoisted_120,[e[159]||(e[159]=createBaseVNode("label",{class:"setting-label"},"日常任务命令执行后延迟(ms)",-1)),createVNode(w,{value:batchSettings.commandDelay,"onUpdate:value":e[48]||(e[48]=n=>batchSettings.commandDelay=n),min:100,max:2e3,step:100,size:"small",style:{width:"100px"}},null,8,["value"])]),createBaseVNode("div",_hoisted_121,[e[160]||(e[160]=createBaseVNode("label",{class:"setting-label"},"日常任务任务间延迟(ms)",-1)),createVNode(w,{value:batchSettings.taskDelay,"onUpdate:value":e[49]||(e[49]=n=>batchSettings.taskDelay=n),min:100,max:2e3,step:100,size:"small",style:{width:"100px"}},null,8,["value"])]),createVNode(S,{"title-placement":"left"},{default:withCtx(()=>[...e[161]||(e[161]=[createTextVNode("连接池高级设置",-1)])]),_:1}),createBaseVNode("div",_hoisted_122,[e[162]||(e[162]=createBaseVNode("label",{class:"setting-label"},"最大并发连接数 (1-10)",-1)),createVNode(w,{value:batchSettings.maxConnections,"onUpdate:value":e[50]||(e[50]=n=>batchSettings.maxConnections=n),min:1,max:10,step:1,size:"small",style:{width:"100px"}},null,8,["value"])]),createBaseVNode("div",_hoisted_123,[e[163]||(e[163]=createBaseVNode("label",{class:"setting-label"},"连接超时时间 (秒)",-1)),createVNode(w,{value:batchSettings.connectionTimeout,"onUpdate:value":e[51]||(e[51]=n=>batchSettings.connectionTimeout=n),min:5e3,max:12e4,step:5e3,size:"small",parse:n=>n/1e3,format:n=>n*1e3,style:{width:"100px"}},null,8,["value","parse","format"])]),createBaseVNode("div",_hoisted_124,[e[164]||(e[164]=createBaseVNode("label",{class:"setting-label"},"任务重试次数 (0-3)",-1)),createVNode(w,{value:batchSettings.taskRetryCount,"onUpdate:value":e[52]||(e[52]=n=>batchSettings.taskRetryCount=n),min:0,max:3,step:1,size:"small",style:{width:"100px"}},null,8,["value"])]),createBaseVNode("div",_hoisted_125,[e[165]||(e[165]=createBaseVNode("label",{class:"setting-label"},"任务间延迟 (毫秒)",-1)),createVNode(w,{value:batchSettings.delayBetweenTasks,"onUpdate:value":e[53]||(e[53]=n=>batchSettings.delayBetweenTasks=n),min:0,max:5e3,step:500,size:"small",style:{width:"100px"}},null,8,["value"])])]),createBaseVNode("div",_hoisted_126,[createVNode(t,{onClick:e[54]||(e[54]=n=>showBatchSettingsModal.value=!1),style:{"margin-right":"12px"}},{default:withCtx(()=>[...e[166]||(e[166]=[createTextVNode("取消",-1)])]),_:1}),createVNode(t,{type:"primary",onClick:saveBatchSettings},{default:withCtx(()=>[...e[167]||(e[167]=[createTextVNode("保存设置",-1)])]),_:1})])])]),_:1},8,["show"])])}}},BatchDailyTasks=_export_sfc(_sfc_main,[["__scopeId","data-v-5528bc58"]]);export{BatchDailyTasks as default};
