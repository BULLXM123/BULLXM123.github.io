import{r as y,e as H,o as W,S as b,V as a,Z as l,$ as o,W as i,N as m,F as X,R as Y,L as Z,a2 as u,X as J,Y as K,ag as Q,U as p,j as _}from"./vue-vendor-CjWJpnUV.js";import{u as ee}from"./gameRoles-C_H-ZCPA.js";import{_ as te}from"./plugin-vueexport-helper-DlAUqK2U.js";import{A as se}from"./Add-Cfs4ZWp-.js";import{E as le}from"./EllipsisHorizontal-DSgZjaEv.js";import{P as ae}from"./PersonCircle-DQ9VUGcu.js";import{u as oe,a as ne}from"./ui-vendor-bYSxkbvo.js";import"./localTokenManager-DDQzZcWL.js";import"./index-DyiAMGIZ.js";import"./utils-C42QaX6I.js";const ie={class:"game-roles-page"},re={class:"container"},de={class:"page-header"},ue={class:"header-content"},ce={class:"header-actions"},ve={key:0,class:"roles-grid"},me=["onClick"],pe={class:"card-header"},_e={class:"role-avatar"},fe=["src","alt"],ge={class:"role-actions"},be={class:"card-body"},ye={class:"role-name"},he={class:"role-info"},Re={class:"role-tags"},ke={class:"card-footer"},we={class:"role-stats"},xe={class:"stat-item"},Ce={class:"stat-value"},Se={class:"stat-item"},ze={class:"stat-value"},Fe={key:1,class:"empty-state"},Ue={class:"modal-actions"},Ge={__name:"GameRoles",setup($e){Q();const c=oe(),U=ne(),r=ee(),d=y(!1),h=y(!1),f=y(null),R=y(null),n=H({name:"",server:"",profession:"",level:1,account:"",note:""}),G={name:[{required:!0,message:"请输入角色名称",trigger:"blur"}],server:[{required:!0,message:"请选择服务器",trigger:"change"}],profession:[{required:!0,message:"请选择职业",trigger:"change"}],level:[{required:!0,type:"number",message:"请输入角色等级",trigger:"blur"}]},$=[{label:"风云服",value:"风云服"},{label:"神话服",value:"神话服"},{label:"传奇服",value:"传奇服"},{label:"梦幻服",value:"梦幻服"},{label:"英雄服",value:"英雄服"}],A=[{label:"战士",value:"战士"},{label:"法师",value:"法师"},{label:"道士",value:"道士"},{label:"刺客",value:"刺客"},{label:"弓手",value:"弓手"},{label:"牧师",value:"牧师"}],N=[{label:"编辑",key:"edit"},{label:"设为主角色",key:"set-primary"},{label:"查看详情",key:"view-details"},{type:"divider"},{label:"删除",key:"delete"}],x=s=>{r.selectRole(s),c.success(`已切换到角色：${s.name}`)},V=async(s,e)=>{switch(s){case"edit":O(e);break;case"set-primary":x(e);break;case"view-details":q();break;case"delete":B(e);break}},O=s=>{f.value=s,Object.assign(n,s),d.value=!0},q=s=>{c.info("角色详情功能开发中...")},B=s=>{U.warning({title:"删除角色",content:`确定要删除角色 "${s.name}" 吗？此操作无法恢复。`,positiveText:"确定删除",negativeText:"取消",onPositiveClick:async()=>{const e=await r.deleteGameRole(s.id);e.success?c.success(e.message):c.error(e.message)}})},E=async()=>{if(R.value)try{await R.value.validate(),h.value=!0;let s;f.value?s=await r.updateGameRole(f.value.id,n):s=await r.addGameRole(n),s.success?(c.success(s.message),d.value=!1,M()):c.error(s.message)}catch{}finally{h.value=!1}},M=()=>{Object.keys(n).forEach(s=>{n[s]=s==="level"?1:""}),f.value=null},P=s=>s>=1e8?(s/1e8).toFixed(1)+"亿":s>=1e4?(s/1e4).toFixed(1)+"万":s.toString();return W(async()=>{r.gameRoles.length===0&&await r.fetchGameRoles()}),(s,e)=>{const k=i("n-icon"),g=i("n-button"),j=i("n-dropdown"),C=i("n-tag"),D=i("n-empty"),w=i("n-input"),v=i("n-form-item"),S=i("n-select"),T=i("n-input-number"),I=i("n-form"),L=i("n-modal");return p(),b("div",ie,[a("div",re,[a("div",de,[a("div",ue,[e[11]||(e[11]=a("div",{class:"header-left"},[a("h1",null,"游戏角色"),a("p",null,"管理您的所有游戏角色")],-1)),a("div",ce,[l(g,{type:"primary",size:"large",onClick:e[0]||(e[0]=t=>d.value=!0)},{icon:o(()=>[l(k,null,{default:o(()=>[l(m(se))]),_:1})]),default:o(()=>[e[10]||(e[10]=_(" 添加角色 ",-1))]),_:1})])])]),m(r).gameRoles.length?(p(),b("div",ve,[(p(!0),b(X,null,Y(m(r).gameRoles,t=>{var z;return p(),b("div",{key:t.id,class:Z(["role-card",{active:t.id===((z=m(r).selectedRole)==null?void 0:z.id)}]),onClick:F=>x(t)},[a("div",pe,[a("div",_e,[a("img",{src:t.avatar||"/icons/xiaoyugan.png",alt:t.name},null,8,fe)]),a("div",ge,[l(j,{options:N,onSelect:F=>V(F,t)},{default:o(()=>[l(g,{text:""},{icon:o(()=>[l(k,null,{default:o(()=>[l(m(le))]),_:1})]),_:1})]),_:1},8,["onSelect"])])]),a("div",be,[a("h3",ye,u(t.name),1),a("p",he,u(t.server)+" | "+u(t.level)+"级",1),a("div",Re,[l(C,{size:"small",type:t.isActive?"success":"default"},{default:o(()=>[_(u(t.isActive?"活跃":"离线"),1)]),_:2},1032,["type"]),t.vip?(p(),J(C,{key:0,size:"small"},{default:o(()=>[...e[12]||(e[12]=[_(" VIP ",-1)])]),_:1})):K("",!0)])]),a("div",ke,[a("div",we,[a("div",xe,[e[13]||(e[13]=a("span",{class:"stat-label"},"经验",-1)),a("span",Ce,u(t.exp||"0"),1)]),a("div",Se,[e[14]||(e[14]=a("span",{class:"stat-label"},"金币",-1)),a("span",ze,u(P(t.gold||0)),1)])])])],10,me)}),128))])):(p(),b("div",Fe,[l(D,{description:"暂无游戏角色",size:"large"},{icon:o(()=>[l(k,{size:"64"},{default:o(()=>[l(m(ae))]),_:1})]),extra:o(()=>[l(g,{type:"primary",size:"large",onClick:e[1]||(e[1]=t=>d.value=!0)},{default:o(()=>[...e[15]||(e[15]=[_(" 添加第一个角色 ",-1)])]),_:1})]),_:1})])),l(L,{show:d.value,"onUpdate:show":e[9]||(e[9]=t=>d.value=t),preset:"card",title:"添加游戏角色",style:{width:"500px"}},{footer:o(()=>[a("div",Ue,[l(g,{onClick:e[8]||(e[8]=t=>d.value=!1)},{default:o(()=>[...e[16]||(e[16]=[_(" 取消 ",-1)])]),_:1}),l(g,{type:"primary",loading:h.value,onClick:E},{default:o(()=>[_(u(f.value?"保存":"添加"),1)]),_:1},8,["loading"])])]),default:o(()=>[l(I,{ref_key:"roleFormRef",ref:R,model:n,rules:G,"label-placement":"left","label-width":"80px"},{default:o(()=>[l(v,{label:"角色名称",path:"name"},{default:o(()=>[l(w,{value:n.name,"onUpdate:value":e[2]||(e[2]=t=>n.name=t),placeholder:"请输入角色名称"},null,8,["value"])]),_:1}),l(v,{label:"服务器",path:"server"},{default:o(()=>[l(S,{value:n.server,"onUpdate:value":e[3]||(e[3]=t=>n.server=t),options:$,placeholder:"请选择服务器"},null,8,["value"])]),_:1}),l(v,{label:"职业",path:"profession"},{default:o(()=>[l(S,{value:n.profession,"onUpdate:value":e[4]||(e[4]=t=>n.profession=t),options:A,placeholder:"请选择职业"},null,8,["value"])]),_:1}),l(v,{label:"等级",path:"level"},{default:o(()=>[l(T,{value:n.level,"onUpdate:value":e[5]||(e[5]=t=>n.level=t),min:1,max:200,placeholder:"角色等级"},null,8,["value"])]),_:1}),l(v,{label:"账号信息"},{default:o(()=>[l(w,{value:n.account,"onUpdate:value":e[6]||(e[6]=t=>n.account=t),placeholder:"游戏账号（可选）"},null,8,["value"])]),_:1}),l(v,{label:"备注"},{default:o(()=>[l(w,{value:n.note,"onUpdate:value":e[7]||(e[7]=t=>n.note=t),type:"textarea",placeholder:"角色备注信息（可选）",rows:3},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["show"])])])}}},De=te(Ge,[["__scopeId","data-v-3a5c5f6d"]]);export{De as default};
